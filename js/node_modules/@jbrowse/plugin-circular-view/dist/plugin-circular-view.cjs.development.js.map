{"version":3,"file":"plugin-circular-view.cjs.development.js","sources":["../src/CircularView/models/viewportVisibleRegion.ts","../src/CircularView/models/slices.ts","../src/CircularView/models/CircularView.ts","../src/BaseChordDisplay/components/Loading.tsx","../src/BaseChordDisplay/components/DisplayError.js","../src/BaseChordDisplay/components/RpcRenderedSvgGroup.js","../src/BaseChordDisplay/components/BaseChordDisplay.tsx","../../../node_modules/regenerator-runtime/runtime.js","../src/BaseChordDisplay/models/renderReaction.js","../src/BaseChordDisplay/models/BaseChordDisplayModel.ts","../src/BaseChordDisplay/models/baseChordDisplayConfig.ts","../src/index.ts","../src/CircularView/components/Ruler.js","../src/CircularView/components/CircularView.js"],"sourcesContent":["function findCircleIntersectionX(\n  y: number,\n  cx: number,\n  cy: number,\n  r: number,\n  resultArray: [number, number][],\n) {\n  const d = Math.abs(y - cy)\n  if (d > r) {\n    return\n  }\n  if (d === r) {\n    resultArray.push([cx, y])\n  }\n  const solution = Math.sqrt(r * r - d * d)\n  resultArray.push([cx - solution, y])\n  resultArray.push([cx + solution, y])\n}\n\nfunction findCircleIntersectionY(\n  x: number,\n  cx: number,\n  cy: number,\n  r: number,\n  resultArray: [number, number][],\n) {\n  const d = Math.abs(x - cx)\n  if (d > r) {\n    return\n  }\n  if (d === r) {\n    resultArray.push([x, cy])\n  }\n  const solution = Math.sqrt(r * r - d * d)\n  resultArray.push([x, cy - solution])\n  resultArray.push([x, cy + solution])\n}\n\nfunction cartesianToTheta(x: number, y: number) {\n  let theta = (Math.atan(y / x) + 2 * Math.PI) % (2 * Math.PI)\n  if (x < 0) {\n    if (y <= 0) {\n      theta += Math.PI\n    } else {\n      theta -= Math.PI\n    }\n  }\n  return theta\n}\n\nexport function cartesianToPolar(x: number, y: number) {\n  const rho = Math.sqrt(x * x + y * y)\n  if (rho === 0) {\n    return [0, 0]\n  }\n  const theta = cartesianToTheta(x, y)\n  return [rho, theta]\n}\n\nconst twoPi = 2 * Math.PI\nexport function thetaRangesOverlap(\n  r1start: number,\n  r1length: number,\n  r2start: number,\n  r2length: number,\n) {\n  if (r1length <= 0 || r2length <= 0) {\n    return false\n  }\n  if (r1length + 0.0001 >= twoPi || r2length + 0.0001 >= twoPi) {\n    return true\n  }\n\n  // put both range starts between 2π and 4π\n  r1start = (((r1start % twoPi) + twoPi) % twoPi) + twoPi\n  r2start = (((r2start % twoPi) + twoPi) % twoPi) + twoPi\n\n  if (r1start < r2start + r2length && r1start + r1length > r2start) {\n    return true\n  }\n\n  // move r2 2π to the left and check\n  r2start -= twoPi\n  if (r1start < r2start + r2length && r1start + r1length > r2start) {\n    return true\n  }\n\n  // move it 2π to the right and check\n  r2start += twoPi + twoPi\n  return r1start < r2start + r2length && r1start + r1length > r2start\n}\n\n// return which arc range has any part of the circle visible in the viewport\nexport function viewportVisibleSection(\n  viewSides: [number, number, number, number],\n  circleCenter: [number, number],\n  circleRadius: number,\n) {\n  let [viewL, viewR, viewT, viewB] = viewSides\n  const [cx, cy] = circleCenter\n\n  // transform coordinate system to center of circle\n  viewL -= cx\n  viewR -= cx\n  viewT -= cy\n  viewB -= cy\n\n  const centerIsInsideViewport =\n    viewL < 0 && viewR > 0 && viewT < 0 && viewB > 0\n\n  if (centerIsInsideViewport) {\n    const vertices = [\n      [viewL, viewT],\n      [viewR, viewT],\n      [viewL, viewB],\n      [viewR, viewB],\n    ]\n    let maxRho = -Infinity\n    for (let i = 0; i < vertices.length; i += 1) {\n      const [x, y] = vertices[i]\n      const rho = Math.sqrt(x * x + y * y)\n      if (rho > maxRho) {\n        maxRho = rho\n      }\n    }\n    return {\n      rho: [0, Math.min(circleRadius, maxRho)],\n      theta: [0, 2 * Math.PI],\n    }\n  }\n  // const viewportCompletelyContainsCircle =\n  //   circleCenter[0] - viewL >= circleRadius &&\n  //   viewR - circleCenter[0] >= circleRadius &&\n  //   circleCenter[1] - viewT >= circleRadius &&\n  //   viewB - circleCenter[1] >= circleRadius\n\n  // if (viewportCompletelyContainsCircle) {\n  //   return [0, 2 * Math.PI]\n  // }\n\n  // const distToCenterSquared = ([x, y]) => {\n  //   const [cx, cy] = circleCenter\n  //   const sq = n => n * n\n  //   return sq(x - cx) + sq(y - cy)\n  // }\n  // const circleRadiusSquared = circleRadius * circleRadius\n\n  // const tlInside = distToCenterSquared([viewL, viewT]) <= circleRadiusSquared\n  // const trInside = distToCenterSquared([viewR, viewT]) <= circleRadiusSquared\n  // const blInside = distToCenterSquared([viewL, viewB]) <= circleRadiusSquared\n  // const brInside = distToCenterSquared([viewR, viewB]) <= circleRadiusSquared\n\n  // const noIntersection = !tlInside && !trInside && !blInside && !brInside\n  // if (noIntersection) return undefined\n\n  // const circleCompletelyContainsViewport =\n  //   tlInside && trInside && blInside && brInside\n  // if (circleCompletelyContainsViewport) {\n  //   // viewport is in the circle, but the center is not in it, so take max\n  //   // and min of thetas to the center\n  //   const thetas = [\n  //     Math.atan(viewT / viewL),\n  //     Math.atan(viewT / viewR),\n  //     Math.atan(viewB / viewL),\n  //     Math.atan(viewB / viewR),\n  //   ]\n\n  //   return [Math.min(...thetas), Math.max(...thetas)]\n  // }\n\n  // if we get here, the viewport is partly in, partly out of the circle\n\n  // const viewLIntersects = Math.abs(viewL - circleCenter[0]) <= circleRadius\n  // const viewRIntersects = Math.abs(viewR - circleCenter[0]) <= circleRadius\n  // const viewTIntersects = Math.abs(viewT - circleCenter[1]) <= circleRadius\n  // const viewBIntersects = Math.abs(viewB - circleCenter[1]) <= circleRadius\n\n  // const numIntersectingSides =\n  //   Number(viewLIntersects) +\n  //   Number(viewRIntersects) +\n  //   Number(viewTIntersects) +\n  //   Number(viewBIntersects)\n\n  // if (numIntersectingSides === 4) return [0, 2 * Math.PI]\n  // if (numIntersectingSides === 3) {\n  //   // TODO calculate the thetas of the\n  // } else if (numIntersectingSides === 2) {\n  //   // TODO calculate the thetas of the 2 intersection points\n  // } else if (numIntersectingSides === 1) {\n  //   // TODO calculate the thetas of the 1-2 intersection points of the line, and the angle between\n  // }\n\n  // make a list of vertices-of-interest that lie inside both shapes to examine\n  // to determine the range covered by their intersection\n\n  // transform coordinates to have the circle as the origin and find the intersections\n  // of the circle and the view rectangle\n  const vertices: [number, number][] = [\n    [viewL, viewT],\n    [viewR, viewT],\n    [viewL, viewB],\n    [viewR, viewB],\n  ]\n  findCircleIntersectionY(viewL, 0, 0, circleRadius, vertices)\n  findCircleIntersectionY(viewR, 0, 0, circleRadius, vertices)\n  findCircleIntersectionX(viewT, 0, 0, circleRadius, vertices)\n  findCircleIntersectionX(viewB, 0, 0, circleRadius, vertices)\n\n  // for each edge, also look at the closest point to center if it is inside the circle\n  if (-viewL < circleRadius) {\n    vertices.push([viewL, 0])\n  }\n  if (viewR < circleRadius) {\n    vertices.push([viewR, 0])\n  }\n  if (-viewT < circleRadius) {\n    vertices.push([0, viewT])\n  }\n  if (viewB < circleRadius) {\n    vertices.push([0, viewB])\n  }\n\n  // const verticesOriginal = vertices.map(([x, y]) => [x + cx, y + cy])\n\n  // now convert them all to polar and take the max and min of rho and theta\n\n  // const viewportCenterTheta = cartesianToTheta(viewR + viewL, viewT + viewB)\n  const reflect = viewL >= 0 ? -1 : 1\n  // viewportCenterTheta < Math.PI / 2 || viewportCenterTheta > 1.5 * Math.PI\n  //   ? -1\n  //   : 1\n  let rhoMin = Infinity\n  let rhoMax = -Infinity\n  let thetaMin = Infinity\n  let thetaMax = -Infinity\n  for (let i = 0; i < vertices.length; i += 1) {\n    // ignore vertex if outside the viewport\n    const [vx, vy] = vertices[i]\n    if (vx >= viewL && vx <= viewR && vy >= viewT && vy <= viewB) {\n      const [rho, theta] = cartesianToPolar(vx * reflect, vy * reflect)\n      // ignore vertex if outside the circle\n      if (rho <= circleRadius + 0.001) {\n        // ignore theta if rho is 0\n        if (theta < thetaMin && rho > 0.0001) {\n          thetaMin = theta\n        }\n        if (theta > thetaMax && rho > 0.0001) {\n          thetaMax = theta\n        }\n        if (rho < rhoMin) {\n          rhoMin = rho\n        }\n        if (rho > rhoMax) {\n          rhoMax = rho\n        }\n      }\n    }\n  }\n\n  if (reflect === -1) {\n    thetaMin += Math.PI\n    thetaMax += Math.PI\n  }\n\n  if (thetaMin > 2 * Math.PI && thetaMax > 2 * Math.PI) {\n    thetaMin -= 2 * Math.PI\n    thetaMax -= 2 * Math.PI\n  }\n\n  return {\n    rho: [rhoMin, Math.min(circleRadius, rhoMax)],\n    theta: [thetaMin, thetaMax],\n  }\n}\n","import {\n  polarToCartesian,\n  assembleLocString,\n  objectFromEntries,\n  Region,\n} from '@jbrowse/core/util'\nimport { thetaRangesOverlap } from './viewportVisibleRegion'\n\nexport class Slice {\n  key: string\n\n  region: Region & { widthBp: number; elided: boolean }\n\n  offsetRadians: number\n\n  startRadians: number\n\n  endRadians: number\n\n  bpPerRadian: number\n\n  radianWidth: number\n\n  flipped: boolean\n\n  constructor(\n    view: { bpPerRadian: number },\n    region: Region & { widthBp: number; elided: boolean },\n    currentRadianOffset: number,\n    radianWidth: number,\n  ) {\n    const { bpPerRadian } = view\n    this.key = assembleLocString(region)\n    this.region = region\n    this.offsetRadians = currentRadianOffset\n    this.bpPerRadian = bpPerRadian\n    this.radianWidth = radianWidth\n    this.flipped = false\n\n    this.startRadians = this.offsetRadians\n    this.endRadians = region.widthBp / this.bpPerRadian + this.offsetRadians\n    Object.freeze(this)\n  }\n\n  bpToXY(bp: number, radiusPx: number) {\n    let offsetBp\n    if (this.region.elided) {\n      offsetBp = this.region.widthBp / 2\n    } else if (this.flipped) {\n      offsetBp = this.region.end - bp\n    } else {\n      offsetBp = bp - this.region.start\n    }\n    const totalRadians = offsetBp / this.bpPerRadian + this.offsetRadians\n    return polarToCartesian(radiusPx, totalRadians)\n  }\n\n  toJSON() {\n    return objectFromEntries(Object.entries(this))\n  }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction calculateStaticSlices(self: any) {\n  const slices = []\n  let currentRadianOffset = 0\n  for (const region of self.elidedRegions) {\n    const radianWidth =\n      region.widthBp / self.bpPerRadian + self.spacingPx / self.pxPerRadian\n    slices.push(new Slice(self, region, currentRadianOffset, radianWidth))\n    currentRadianOffset += radianWidth\n  }\n  return slices\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction sliceIsVisible(self: any, slice: Slice) {\n  const {\n    // rho: visibleRhoRange,\n    theta: [visibleThetaMin, visibleThetaMax],\n  } = self.visibleSection\n\n  return thetaRangesOverlap(\n    slice.offsetRadians + self.offsetRadians,\n    slice.radianWidth,\n    visibleThetaMin,\n    visibleThetaMax - visibleThetaMin,\n  )\n}\n\nexport { calculateStaticSlices, sliceIsVisible }\n","import { AnyConfigurationModel } from '@jbrowse/core/configuration/configurationSchema'\nimport PluginManager from '@jbrowse/core/PluginManager'\nimport {\n  SnapshotOrInstance,\n  Instance,\n  types,\n  getParent,\n  resolveIdentifier,\n  getRoot,\n  cast,\n} from 'mobx-state-tree'\nimport { Region } from '@jbrowse/core/util/types/mst'\nimport { transaction } from 'mobx'\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport {\n  getSession,\n  clamp,\n  isSessionModelWithWidgets,\n} from '@jbrowse/core/util'\nimport { BaseViewModel } from '@jbrowse/core/pluggableElementTypes/models'\nimport { calculateStaticSlices, sliceIsVisible } from './slices'\n\nimport { viewportVisibleSection } from './viewportVisibleRegion'\n\nexport default function CircularView(pluginManager: PluginManager) {\n  const minHeight = 40\n  const minWidth = 100\n  const defaultHeight = 400\n  return types.compose(\n    BaseViewModel,\n    types\n      .model('CircularView', {\n        type: types.literal('CircularView'),\n        offsetRadians: -Math.PI / 2,\n        bpPerPx: 2000000,\n        tracks: types.array(\n          pluginManager.pluggableMstType('track', 'stateModel'),\n        ),\n\n        hideVerticalResizeHandle: false,\n        hideTrackSelectorButton: false,\n        lockedFitToWindow: true,\n        disableImportForm: false,\n\n        height: types.optional(\n          types.refinement('trackHeight', types.number, n => n >= minHeight),\n          defaultHeight,\n        ),\n        minimumRadiusPx: 25,\n        spacingPx: 10,\n        paddingPx: 80,\n        lockedPaddingPx: 100,\n        minVisibleWidth: 6,\n        minimumBlockWidth: 20,\n        displayedRegions: types.array(Region),\n        scrollX: 0,\n        scrollY: 0,\n        trackSelectorType: 'hierarchical',\n      })\n      .volatile(() => ({\n        width: 800,\n      }))\n      .views(self => ({\n        get staticSlices() {\n          return calculateStaticSlices(self)\n        },\n        get visibleStaticSlices() {\n          return this.staticSlices.filter(sliceIsVisible.bind(this, self))\n        },\n        get visibleSection() {\n          return viewportVisibleSection(\n            [\n              self.scrollX,\n              self.scrollX + self.width,\n              self.scrollY,\n              self.scrollY + self.height,\n            ],\n            this.centerXY,\n            this.radiusPx,\n          )\n        },\n        get circumferencePx() {\n          let elidedBp = 0\n          for (const r of this.elidedRegions) {\n            elidedBp += r.widthBp\n          }\n          return (\n            elidedBp / self.bpPerPx + self.spacingPx * this.elidedRegions.length\n          )\n        },\n        get radiusPx() {\n          return this.circumferencePx / (2 * Math.PI)\n        },\n        get bpPerRadian() {\n          return self.bpPerPx * this.radiusPx\n        },\n        get pxPerRadian() {\n          return this.radiusPx\n        },\n        get centerXY(): [number, number] {\n          return [\n            this.radiusPx + self.paddingPx,\n            this.radiusPx + self.paddingPx,\n          ]\n        },\n        get totalBp() {\n          let total = 0\n          for (const region of self.displayedRegions) {\n            total += region.end - region.start\n          }\n          return total\n        },\n        get maximumRadiusPx() {\n          return self.lockedFitToWindow\n            ? Math.min(self.width, self.height) / 2 - self.lockedPaddingPx\n            : 1000000\n        },\n        get maxBpPerPx() {\n          const minCircumferencePx = 2 * Math.PI * self.minimumRadiusPx\n          return this.totalBp / minCircumferencePx\n        },\n        get minBpPerPx() {\n          // min depends on window dimensions, clamp between old min(0.01) and max\n          const maxCircumferencePx = 2 * Math.PI * this.maximumRadiusPx\n          return clamp(\n            this.totalBp / maxCircumferencePx,\n            0.0000000001,\n            this.maxBpPerPx,\n          )\n        },\n        get atMaxBpPerPx() {\n          return self.bpPerPx >= this.maxBpPerPx\n        },\n        get atMinBpPerPx() {\n          return self.bpPerPx <= this.minBpPerPx\n        },\n        get tooSmallToLock() {\n          return this.minBpPerPx <= 0.0000000001\n        },\n        get figureDimensions() {\n          return [\n            this.radiusPx * 2 + 2 * self.paddingPx,\n            this.radiusPx * 2 + 2 * self.paddingPx,\n          ]\n        },\n        get figureWidth() {\n          return this.figureDimensions[0]\n        },\n        get figureHeight() {\n          return this.figureDimensions[1]\n        },\n        // this is displayedRegions, post-processed to\n        // elide regions that are too small to see reasonably\n        get elidedRegions() {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          const visible: any[] = []\n          self.displayedRegions.forEach(region => {\n            const widthBp = region.end - region.start\n            const widthPx = widthBp / self.bpPerPx\n            if (widthPx < self.minVisibleWidth) {\n              // too small to see, collapse into a single elision region\n              const lastVisible = visible[visible.length - 1]\n              if (lastVisible && lastVisible.elided) {\n                lastVisible.regions.push({ ...region })\n                lastVisible.widthBp += widthBp\n              } else {\n                visible.push({\n                  elided: true,\n                  widthBp,\n                  regions: [{ ...region }],\n                })\n              }\n            } else {\n              // big enough to see, display it\n              visible.push({ ...region, widthBp })\n            }\n          })\n\n          // remove any single-region elisions\n          for (let i = 0; i < visible.length; i += 1) {\n            const v = visible[i]\n            if (v.elided && v.regions.length === 1) {\n              delete v.elided\n              visible[i] = { ...v, ...v.regions[0] }\n            }\n          }\n          return visible\n        },\n\n        get assemblyNames() {\n          const assemblyNames: string[] = []\n          self.displayedRegions.forEach(displayedRegion => {\n            if (!assemblyNames.includes(displayedRegion.assemblyName)) {\n              assemblyNames.push(displayedRegion.assemblyName)\n            }\n          })\n          return assemblyNames\n        },\n      }))\n      .volatile(() => ({\n        error: undefined as Error | undefined,\n      }))\n      .actions(self => ({\n        // toggle action with a flag stating which mode it's in\n        setWidth(newWidth: number) {\n          self.width = Math.max(newWidth, minWidth)\n          return self.width\n        },\n        setHeight(newHeight: number) {\n          self.height = Math.max(newHeight, minHeight)\n          return self.height\n        },\n        resizeHeight(distance: number) {\n          const oldHeight = self.height\n          const newHeight = this.setHeight(self.height + distance)\n          this.setModelViewWhenAdjust(!self.tooSmallToLock)\n          return newHeight - oldHeight\n        },\n        resizeWidth(distance: number) {\n          const oldWidth = self.width\n          const newWidth = this.setWidth(self.width + distance)\n          this.setModelViewWhenAdjust(!self.tooSmallToLock)\n          return newWidth - oldWidth\n        },\n        rotateClockwiseButton() {\n          this.rotateClockwise(Math.PI / 6)\n        },\n\n        rotateCounterClockwiseButton() {\n          this.rotateCounterClockwise(Math.PI / 6)\n        },\n\n        rotateClockwise(distance = 0.17) {\n          self.offsetRadians += distance\n        },\n\n        rotateCounterClockwise(distance = 0.17) {\n          self.offsetRadians -= distance\n        },\n\n        zoomInButton() {\n          this.setBpPerPx(self.bpPerPx / 1.4)\n        },\n\n        zoomOutButton() {\n          this.setBpPerPx(self.bpPerPx * 1.4)\n        },\n\n        setBpPerPx(newVal: number) {\n          self.bpPerPx = clamp(newVal, self.minBpPerPx, self.maxBpPerPx)\n        },\n\n        setModelViewWhenAdjust(secondCondition: boolean) {\n          if (self.lockedFitToWindow && secondCondition) {\n            this.setBpPerPx(self.minBpPerPx)\n          }\n        },\n\n        closeView() {\n          getParent(self, 2).removeView(self)\n        },\n\n        setDisplayedRegions(regions: SnapshotOrInstance<typeof Region>[]) {\n          const previouslyEmpty = self.displayedRegions.length === 0\n          self.displayedRegions = cast(regions)\n\n          if (previouslyEmpty) {\n            this.setBpPerPx(self.minBpPerPx)\n          } else {\n            this.setBpPerPx(self.bpPerPx)\n          }\n        },\n\n        activateTrackSelector() {\n          if (self.trackSelectorType === 'hierarchical') {\n            const session = getSession(self)\n            if (isSessionModelWithWidgets(session)) {\n              const selector = session.addWidget(\n                'HierarchicalTrackSelectorWidget',\n                'hierarchicalTrackSelector',\n                { view: self },\n              )\n              session.showWidget(selector)\n              return selector\n            }\n          }\n          throw new Error(\n            `invalid track selector type ${self.trackSelectorType}`,\n          )\n        },\n\n        toggleTrack(trackId: string) {\n          // if we have any tracks with that configuration, turn them off\n          const hiddenCount = this.hideTrack(trackId)\n          // if none had that configuration, turn one on\n          if (!hiddenCount) {\n            this.showTrack(trackId)\n          }\n        },\n\n        setError(error: Error) {\n          console.error(error)\n          self.error = error\n        },\n\n        showTrack(trackId: string, initialSnapshot = {}) {\n          const trackConfigSchema = pluginManager.pluggableConfigSchemaType(\n            'track',\n          )\n          const configuration = resolveIdentifier(\n            trackConfigSchema,\n            getRoot(self),\n            trackId,\n          )\n          const trackType = pluginManager.getTrackType(configuration.type)\n          if (!trackType) {\n            throw new Error(`unknown track type ${configuration.type}`)\n          }\n          const viewType = pluginManager.getViewType(self.type)\n          const supportedDisplays = viewType.displayTypes.map(\n            displayType => displayType.name,\n          )\n          const displayConf = configuration.displays.find(\n            (d: AnyConfigurationModel) => supportedDisplays.includes(d.type),\n          )\n          const track = trackType.stateModel.create({\n            ...initialSnapshot,\n            type: configuration.type,\n            configuration,\n            displays: [{ type: displayConf.type, configuration: displayConf }],\n          })\n          self.tracks.push(track)\n        },\n\n        addTrackConf(\n          configuration: AnyConfigurationModel,\n          initialSnapshot = {},\n        ) {\n          const { type } = configuration\n          const name = readConfObject(configuration, 'name')\n          const trackType = pluginManager.getTrackType(type)\n          if (!trackType) {\n            throw new Error(`unknown track type ${configuration.type}`)\n          }\n          const viewType = pluginManager.getViewType(self.type)\n          const supportedDisplays = viewType.displayTypes.map(\n            displayType => displayType.name,\n          )\n          const displayConf = configuration.displays.find(\n            (d: AnyConfigurationModel) => supportedDisplays.includes(d.type),\n          )\n          const track = trackType.stateModel.create({\n            ...initialSnapshot,\n            name,\n            type,\n            configuration,\n            displays: [{ type: displayConf.type, configuration: displayConf }],\n          })\n          self.tracks.push(track)\n        },\n\n        hideTrack(trackId: string) {\n          const trackConfigSchema = pluginManager.pluggableConfigSchemaType(\n            'track',\n          )\n          const configuration = resolveIdentifier(\n            trackConfigSchema,\n            getRoot(self),\n            trackId,\n          )\n          // if we have any tracks with that configuration, turn them off\n          const shownTracks = self.tracks.filter(\n            t => t.configuration === configuration,\n          )\n          transaction(() => shownTracks.forEach(t => self.tracks.remove(t)))\n          return shownTracks.length\n        },\n\n        toggleFitToWindowLock() {\n          self.lockedFitToWindow = !self.lockedFitToWindow\n          // when going unlocked -> locked and circle is cut off, set to the locked minBpPerPx\n          this.setModelViewWhenAdjust(self.atMinBpPerPx)\n          return self.lockedFitToWindow\n        },\n      })),\n  )\n}\n\nexport type CircularViewStateModel = ReturnType<typeof CircularView>\nexport type CircularViewModel = Instance<CircularViewStateModel>\n\n/*\nPLANS\n\n- tracks\n- ruler tick marks\n- set viewport scroll from state snapshot\n\n*/\n","import PluginManager from '@jbrowse/core/PluginManager'\n\nexport default (pluginManager: PluginManager) => {\n  const { lib } = pluginManager\n  const React = lib.react\n  const { useState, useEffect } = React\n  const { makeStyles } = lib['@material-ui/core/styles']\n  const { observer } = lib['mobx-react']\n\n  const useStyles = makeStyles(theme => {\n    const offset = 2\n    const duration = 1.4\n    return {\n      path: {\n        strokeDasharray: 187,\n        strokeDashoffset: 50,\n        animation: `$dash ${duration}s ease-in-out infinite, $colors ${\n          duration * 4\n        }s ease-in-out infinite`,\n      },\n      '@keyframes colors': {\n        '0%': {\n          stroke: theme.palette.primary.light,\n        },\n        '25%': {\n          stroke: theme.palette.secondary.light,\n        },\n        '50%': {\n          stroke: theme.palette.tertiary.light,\n        },\n        '75%': {\n          stroke: theme.palette.quaternary.light,\n        },\n        '100%': {\n          stroke: theme.palette.primary.light,\n        },\n      },\n      '@keyframes dash': {\n        '0%': {\n          strokeDashoffset: offset,\n        },\n        '50%': {\n          strokeDashoffset: offset / 4,\n          transform: 'rotate(135deg)',\n        },\n        '100%': {\n          strokeDashoffset: offset,\n          transform: 'rotate(720deg)',\n        },\n      },\n    }\n  })\n\n  // 'repeating-linear-gradient(45deg, transparent, transparent 5px, rgba(255,255,255,.5) 5px, rgba(255,255,255,.5) 10px)',\n  const Loading = observer(\n    ({\n      model: {\n        renderProps: { radius },\n      },\n    }: {\n      model: { renderProps: { radius: number } }\n    }) => {\n      const classes = useStyles()\n\n      // only show the loading message after 400ms to prevent excessive flickering\n      const [shown, setShown] = useState(false)\n      useEffect(() => {\n        const timeout = setTimeout(() => setShown(true), 400)\n        return () => clearTimeout(timeout)\n      })\n\n      return !shown ? null : (\n        <g>\n          <defs>\n            <pattern\n              id=\"diagonalHatch\"\n              width=\"10\"\n              height=\"10\"\n              patternTransform=\"rotate(45 0 0)\"\n              patternUnits=\"userSpaceOnUse\"\n            >\n              <line\n                x1=\"0\"\n                y1=\"0\"\n                x2=\"0\"\n                y2=\"10\"\n                style={{ stroke: 'rgba(255,255,255,0.5)', strokeWidth: 10 }}\n              />\n            </pattern>\n          </defs>\n          <circle cx=\"0\" cy=\"0\" r={radius} fill=\"#f1f1f1\" />\n          <circle cx=\"0\" cy=\"0\" r={radius} fill=\"url(#diagonalHatch)\" />\n          <text\n            x=\"0\"\n            y=\"0\"\n            transform=\"rotate(90 0 0)\"\n            dominantBaseline=\"middle\"\n            textAnchor=\"middle\"\n          >\n            Loading&hellip;\n          </text>\n          <circle\n            className={classes.path}\n            fill=\"none\"\n            strokeWidth=\"4\"\n            strokeLinecap=\"round\"\n            cx=\"0\"\n            cy=\"0\"\n            r=\"60\"\n          />\n        </g>\n      )\n    },\n  )\n\n  return Loading\n}\n","export default ({ jbrequire }) => {\n  const React = jbrequire('react')\n  const { makeStyles } = jbrequire('@material-ui/core/styles')\n  const { observer } = jbrequire('mobx-react')\n\n  const useStyles = makeStyles({\n    errorMessage: {},\n    errorBackground: {},\n    errorText: {},\n  })\n\n  // 'repeating-linear-gradient(45deg, transparent, transparent 5px, rgba(255,255,255,.5) 5px, rgba(255,255,255,.5) 10px)',\n  const DisplayError = observer(\n    ({\n      model: {\n        renderProps: { radius },\n        error,\n      },\n    }) => {\n      const classes = useStyles()\n      return (\n        <g className={classes.errorMessage}>\n          <defs>\n            <pattern\n              id=\"diagonalHatch\"\n              width=\"10\"\n              height=\"10\"\n              patternTransform=\"rotate(45 0 0)\"\n              patternUnits=\"userSpaceOnUse\"\n            >\n              <line\n                x1=\"0\"\n                y1=\"0\"\n                x2=\"0\"\n                y2=\"10\"\n                style={{ stroke: 'rgba(255,0,0,0.5)', strokeWidth: 10 }}\n              />\n            </pattern>\n          </defs>\n          <circle\n            className={classes.errorBackground}\n            cx=\"0\"\n            cy=\"0\"\n            r={radius}\n            fill=\"#ffb4b4\"\n          />\n          <circle\n            className={classes.errorPattern}\n            cx=\"0\"\n            cy=\"0\"\n            r={radius}\n            fill=\"url(#diagonalHatch)\"\n          />\n          <text\n            className={classes.errorText}\n            x=\"0\"\n            y=\"0\"\n            transform=\"rotate(90 0 0)\"\n            dominantBaseline=\"middle\"\n            textAnchor=\"middle\"\n          >\n            {String(error)}\n          </text>\n        </g>\n      )\n    },\n  )\n\n  return DisplayError\n}\n","export default ({ jbrequire }) => {\n  const React = jbrequire('react')\n  const { isAlive } = jbrequire('mobx-state-tree')\n  const { useEffect, useRef } = React\n  const { observer, PropTypes: MobxPropTypes } = jbrequire('mobx-react')\n  const { unmountComponentAtNode, hydrate } = jbrequire('react-dom')\n  const { rIC } = jbrequire('@jbrowse/core/util')\n\n  function RpcRenderedSvgGroup({ model }) {\n    const { data, html, filled, renderProps, renderingComponent } = model\n\n    const ssrContainerNode = useRef(null)\n\n    useEffect(() => {\n      const domNode = ssrContainerNode.current\n      function doHydrate() {\n        if (domNode && filled) {\n          if (domNode && domNode.innerHTML) {\n            domNode.style.display = 'none'\n            unmountComponentAtNode(domNode)\n          }\n          domNode.style.display = 'inline'\n          domNode.innerHTML = html\n          // use requestIdleCallback to defer main-thread rendering\n          // and hydration for when we have some free time. helps\n          // keep the framerate up.\n          rIC(() => {\n            if (!isAlive(model)) {\n              return\n            }\n            const mainThreadRendering = React.createElement(\n              renderingComponent,\n              { ...data, ...renderProps },\n              null,\n            )\n            rIC(() => {\n              if (!isAlive(model)) {\n                return\n              }\n              hydrate(mainThreadRendering, domNode)\n            })\n          })\n        }\n      }\n      doHydrate()\n      return () => {\n        if (domNode) {\n          unmountComponentAtNode(domNode)\n        }\n      }\n    })\n\n    return <g ref={ssrContainerNode} />\n  }\n\n  RpcRenderedSvgGroup.propTypes = {\n    model: MobxPropTypes.observableObject.isRequired,\n  }\n\n  return observer(RpcRenderedSvgGroup)\n}\n","import PluginManager from '@jbrowse/core/PluginManager'\nimport ChordDisplayLoadingFactory from './Loading'\nimport ChordDisplayErrorFactory from './DisplayError'\nimport RpcRenderedSvgGroupF from './RpcRenderedSvgGroup'\n\nexport default ({ lib, load }: PluginManager) => {\n  const React = lib.react\n  const { observer, PropTypes: MobxPropTypes } = lib['mobx-react']\n\n  const Loading = load(ChordDisplayLoadingFactory)\n  const DisplayError = load(ChordDisplayErrorFactory)\n  const RpcRenderedSvgGroup = load(RpcRenderedSvgGroupF)\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  function BaseChordDisplay({ display }: any) {\n    if (display.error) {\n      return <DisplayError model={display} />\n    }\n    if (!display.filled) {\n      return <Loading model={display} />\n    }\n    return <RpcRenderedSvgGroup model={display} />\n  }\n  BaseChordDisplay.propTypes = {\n    display: MobxPropTypes.observableObject.isRequired,\n  }\n  return observer(BaseChordDisplay)\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","export default ({ jbrequire }) => {\n  const { getRpcSessionId } = jbrequire('@jbrowse/core/util/tracks')\n  const { getContainingView } = jbrequire('@jbrowse/core/util')\n  const { getSession } = jbrequire('@jbrowse/core/util')\n\n  function renderReactionData(self) {\n    const display = self\n    const view = getContainingView(display)\n    const { rendererType, renderProps } = display\n    const { rpcManager } = getSession(view)\n\n    const a = {\n      rendererType,\n      rpcManager,\n      renderProps,\n      renderArgs: {\n        // TODO: Figure this out for multiple assembly names\n        assemblyName: view.displayedRegions[0]?.assemblyName,\n        adapterConfig: JSON.parse(JSON.stringify(display.adapterConfig)),\n        rendererType: rendererType.name,\n        regions: JSON.parse(JSON.stringify(view.displayedRegions)),\n        blockDefinitions: view.blockDefinitions,\n        sessionId: getRpcSessionId(display),\n        timeout: 1000000, // 10000,\n      },\n    }\n    return a\n  }\n\n  async function renderReactionEffect(props, signal, self) {\n    if (!props) {\n      throw new Error('cannot render with no props')\n    }\n\n    const {\n      rendererType,\n      rpcManager,\n      cannotBeRenderedReason,\n      renderArgs,\n      renderProps,\n    } = props\n\n    if (cannotBeRenderedReason) {\n      return { message: cannotBeRenderedReason }\n    }\n\n    // don't try to render 0 or NaN radius or no regions\n    if (\n      !props.renderProps.radius ||\n      !props.renderArgs.regions ||\n      !props.renderArgs.regions.length\n    ) {\n      return { message: 'Skipping render' }\n    }\n\n    // check renderertype compatibility\n    if (!self.isCompatibleWithRenderer(rendererType)) {\n      throw new Error(\n        `renderer ${rendererType.name} is not compatible with this display type`,\n      )\n    }\n\n    const { html, ...data } = await rendererType.renderInClient(rpcManager, {\n      ...renderArgs,\n      ...renderProps,\n      signal,\n    })\n\n    return { html, data, renderingComponent: rendererType.ReactComponent }\n  }\n\n  return { renderReactionData, renderReactionEffect }\n}\n","import { getConf } from '@jbrowse/core/configuration'\nimport { BaseDisplay } from '@jbrowse/core/pluggableElementTypes/models'\nimport CircularChordRendererType from '@jbrowse/core/pluggableElementTypes/renderers/CircularChordRendererType'\nimport RendererType from '@jbrowse/core/pluggableElementTypes/renderers/RendererType'\nimport {\n  getContainingView,\n  getSession,\n  makeAbortableReaction,\n  AnyReactComponentType,\n} from '@jbrowse/core/util'\nimport { Feature, isFeature } from '@jbrowse/core/util/simpleFeature'\nimport {\n  getParentRenderProps,\n  getRpcSessionId,\n  getTrackAssemblyNames,\n} from '@jbrowse/core/util/tracks'\nimport { Region } from '@jbrowse/core/util/types'\nimport { getParent, isAlive, types, getEnv } from 'mobx-state-tree'\nimport React from 'react'\nimport renderReactionFactory from './renderReaction'\nimport { CircularViewModel } from '../../CircularView/models/CircularView'\n\nexport const BaseChordDisplayModel = types\n  .compose(\n    'BaseChordDisplay',\n    BaseDisplay,\n    types.model({\n      bezierRadiusRatio: 0.1,\n      assemblyName: types.maybe(types.string),\n    }),\n  )\n  .volatile(() => {\n    return {\n      // NOTE: all this volatile stuff has to be filled in at once\n      // so that it stays consistent\n      filled: false,\n      reactElement: undefined as React.ReactElement | undefined,\n      data: undefined,\n      message: '',\n      error: undefined as Error | undefined,\n      renderingComponent: undefined as undefined | AnyReactComponentType,\n      refNameMap: undefined as Record<string, string> | undefined,\n    }\n  })\n  .actions(self => {\n    const { pluginManager } = getEnv(self)\n    const track = self\n    return {\n      onChordClick(feature: Feature) {\n        getConf(self, 'onChordClick', { feature, track, pluginManager })\n      },\n    }\n  })\n  .views(self => ({\n    get blockDefinitions() {\n      const origSlices = (getContainingView(self) as CircularViewModel)\n        .staticSlices\n      if (!self.refNameMap) {\n        return origSlices\n      }\n\n      const slices = JSON.parse(JSON.stringify(origSlices))\n\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      slices.forEach((slice: any) => {\n        const regions = slice.region.elided\n          ? slice.region.regions\n          : [slice.region]\n        regions.forEach((region: Region) => {\n          const renamed = self.refNameMap?.[region.refName]\n          if (renamed && region.refName !== renamed) {\n            region.refName = renamed\n          }\n        })\n      })\n      return slices\n    },\n\n    get renderProps() {\n      const view = getContainingView(self) as CircularViewModel\n      return {\n        ...getParentRenderProps(self),\n        rpcDriverName: self.rpcDriverName,\n        displayModel: self,\n        bezierRadius: view.radiusPx * self.bezierRadiusRatio,\n        radius: view.radiusPx,\n        blockDefinitions: this.blockDefinitions,\n        onChordClick: self.onChordClick,\n      }\n    },\n\n    /**\n     * the pluggable element type object for this diplay's\n     * renderer\n     */\n    get rendererType() {\n      const display = self\n      const { pluginManager } = getEnv(self)\n      const ThisRendererType = pluginManager.getRendererType(\n        self.rendererTypeName,\n      )\n      if (!ThisRendererType) {\n        throw new Error(`renderer \"${display.rendererTypeName}\" not found`)\n      }\n      if (!ThisRendererType.ReactComponent) {\n        throw new Error(\n          `renderer ${display.rendererTypeName} has no ReactComponent, it may not be completely implemented yet`,\n        )\n      }\n      return ThisRendererType\n    },\n\n    isCompatibleWithRenderer(renderer: RendererType) {\n      return !!(renderer instanceof CircularChordRendererType)\n    },\n\n    /**\n     * returns a string feature ID if the globally-selected object\n     * is probably a feature\n     */\n    get selectedFeatureId() {\n      if (!isAlive(self)) {\n        return undefined\n      }\n      const session = getSession(self)\n      if (!session) {\n        return undefined\n      }\n      const { selection } = session\n      // does it quack like a feature?\n      if (isFeature(selection)) {\n        return selection.id()\n      }\n      return undefined\n    },\n  }))\n  .actions(self => ({\n    renderStarted() {\n      self.filled = false\n      self.message = ''\n      self.reactElement = undefined\n      self.data = undefined\n      self.error = undefined\n      self.renderingComponent = undefined\n    },\n    renderSuccess({\n      message,\n      data,\n      reactElement,\n      renderingComponent,\n    }: {\n      message: string\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      data: any\n      reactElement: React.ReactElement\n      renderingComponent: AnyReactComponentType\n    }) {\n      if (message) {\n        self.filled = false\n        self.message = message\n        self.reactElement = undefined\n        self.data = undefined\n        self.error = undefined\n        self.renderingComponent = undefined\n      } else {\n        self.filled = true\n        self.message = ''\n        self.reactElement = reactElement\n        self.data = data\n        self.error = undefined\n        self.renderingComponent = renderingComponent\n      }\n    },\n    renderError(error: Error) {\n      console.error(error)\n      // the rendering failed for some reason\n      self.filled = false\n      self.message = ''\n      self.reactElement = undefined\n      self.data = undefined\n      self.error = error\n      self.renderingComponent = undefined\n    },\n\n    setRefNameMap(refNameMap: Record<string, string>) {\n      self.refNameMap = refNameMap\n    },\n    setError(error: Error) {\n      self.error = error\n    },\n  }))\n  .actions(self => {\n    const { pluginManager } = getEnv(self)\n    const {\n      renderReactionData,\n      renderReactionEffect,\n    } = pluginManager.jbrequire(renderReactionFactory)\n    return {\n      afterAttach() {\n        makeAbortableReaction(\n          self,\n          renderReactionData,\n          renderReactionEffect,\n          {\n            name: `${self.type} ${self.id} rendering`,\n            // delay: self.renderDelay || 300,\n            fireImmediately: true,\n          },\n          self.renderStarted,\n          self.renderSuccess,\n          self.renderError,\n        )\n        makeAbortableReaction(\n          self,\n          () => ({\n            assemblyNames: getTrackAssemblyNames(self.parentTrack) as string[],\n            adapter: getConf(getParent(self, 2), 'adapter'),\n            assemblyManager: getSession(self).assemblyManager,\n          }),\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          async ({ assemblyNames, adapter, assemblyManager }: any, signal) => {\n            return assemblyManager.getRefNameMapForAdapter(\n              adapter,\n              assemblyNames[0],\n              { signal, sessionId: getRpcSessionId(self) },\n            )\n          },\n          {\n            name: `${self.type} ${self.id} getting refNames`,\n            fireImmediately: true,\n          },\n          () => {},\n          refNameMap => {\n            self.setRefNameMap(refNameMap)\n          },\n          error => {\n            console.error(error)\n            self.setError(error)\n          },\n        )\n      },\n    }\n  })\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nconst baseChordDisplayConfig = ConfigurationSchema(\n  'BaseChordDisplay',\n  {\n    onChordClick: {\n      type: 'boolean',\n      description:\n        'callback that should be run when a chord in the track is clicked',\n      defaultValue: false,\n      contextVariable: ['feature', 'track', 'pluginManager'],\n    },\n  },\n  { explicitIdentifier: 'displayId' },\n)\n\nexport { baseChordDisplayConfig }\n","import { lazy } from 'react'\nimport { AbstractSessionModel, isAbstractMenuManager } from '@jbrowse/core/util'\nimport PluginManager from '@jbrowse/core/PluginManager'\nimport Plugin from '@jbrowse/core/Plugin'\nimport ViewType from '@jbrowse/core/pluggableElementTypes/ViewType'\nimport DataUsageIcon from '@material-ui/icons/DataUsage'\nimport stateModelFactory from './CircularView/models/CircularView'\n\nexport default class CircularViewPlugin extends Plugin {\n  name = 'CircularViewPlugin'\n\n  install(pluginManager: PluginManager) {\n    pluginManager.addViewType(\n      () =>\n        new ViewType({\n          ReactComponent: lazy(\n            () => import('./CircularView/components/CircularView'),\n          ),\n          stateModel: stateModelFactory(pluginManager),\n          name: 'CircularView',\n        }),\n    )\n  }\n\n  configure(pluginManager: PluginManager) {\n    if (isAbstractMenuManager(pluginManager.rootModel)) {\n      pluginManager.rootModel.appendToSubMenu(['File', 'Add'], {\n        label: 'Circular view',\n        icon: DataUsageIcon,\n        onClick: (session: AbstractSessionModel) => {\n          session.addView('CircularView', {})\n        },\n      })\n    }\n  }\n}\n\nexport {\n  BaseChordDisplayModel,\n  baseChordDisplayConfig,\n  BaseChordDisplayComponentFactory,\n} from './BaseChordDisplay'\n","import React from 'react'\nimport { observer } from 'mobx-react'\nimport {\n  getSession,\n  polarToCartesian,\n  radToDeg,\n  assembleLocString,\n} from '@jbrowse/core/util'\nimport { makeContrasting } from '@jbrowse/core/util/color'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles({\n  rulerLabel: {\n    fontSize: '0.8rem',\n    fontWeight: 500,\n    lineHeight: 1.6,\n    letterSpacing: '0.0075em',\n  },\n})\n\nfunction sliceArcPath(slice, radiusPx, startBase, endBase) {\n  // A rx ry x-axis-rotation large-arc-flag sweep-flag x y\n  if (slice.flipped) {\n    ;[startBase, endBase] = [endBase, startBase]\n  }\n  const startXY = slice.bpToXY(startBase, radiusPx)\n  const endXY = slice.bpToXY(endBase, radiusPx)\n  const largeArc =\n    Math.abs(endBase - startBase) / slice.bpPerRadian > Math.PI ? '1' : '0'\n  const sweepFlag = '1'\n  return [\n    'M',\n    ...startXY,\n    'A',\n    radiusPx,\n    radiusPx,\n    '0',\n    largeArc,\n    sweepFlag,\n    ...endXY,\n  ].join(' ')\n}\n\nconst ElisionRulerArc = observer(({ model, slice }) => {\n  const theme = useTheme()\n  const { radiusPx: modelRadiusPx } = model\n  const radiusPx = modelRadiusPx + 1\n  const { endRadians, startRadians, region } = slice\n  const startXY = polarToCartesian(radiusPx, startRadians)\n  const endXY = polarToCartesian(radiusPx, endRadians)\n  const widthPx = (endRadians - startRadians) * radiusPx\n  const largeArc = endRadians - startRadians > Math.PI ? '1' : '0'\n  // TODO: draw the elision\n  const centerRadians = (endRadians + startRadians) / 2\n  const regionCountString = `[${Number(\n    region.regions.length,\n  ).toLocaleString()}]`\n  return (\n    <>\n      <RulerLabel\n        text={regionCountString}\n        view={model}\n        maxWidthPx={widthPx}\n        radians={centerRadians}\n        radiusPx={radiusPx}\n        title={`${Number(region.regions.length).toLocaleString()} more regions`}\n        color={theme.palette.text.primary}\n      />\n      <path\n        d={[\n          'M',\n          ...startXY,\n          'A',\n          radiusPx,\n          radiusPx,\n          '0',\n          largeArc,\n          '1',\n          ...endXY,\n        ].join(' ')}\n        stroke={theme.palette.text.secondary}\n        strokeWidth={2}\n        strokeDasharray=\"2,2\"\n        fill=\"none\"\n      />\n    </>\n  )\n})\n\nconst RulerLabel = observer(\n  ({ view, text, maxWidthPx, radians, radiusPx, title, color }) => {\n    const classes = useStyles()\n    const textXY = polarToCartesian(radiusPx + 5, radians)\n    if (!text) {\n      return null\n    }\n\n    if (text.length * 6.5 < maxWidthPx) {\n      // text is rotated parallel to the ruler arc\n      return (\n        <text\n          x={0}\n          y={0}\n          className={classes.rulerLabel}\n          textAnchor=\"middle\"\n          dominantBaseline=\"baseline\"\n          transform={`translate(${textXY}) rotate(${radToDeg(radians) + 90})`}\n          style={{ fill: color }}\n        >\n          {text}\n          <title>{title || text}</title>\n        </text>\n      )\n    }\n    if (maxWidthPx > 4) {\n      // text is rotated perpendicular to the ruler arc\n      const overallRotation = radToDeg(\n        radians + view.offsetRadians - Math.PI / 2,\n      )\n      if (overallRotation >= 180) {\n        return (\n          <text\n            x={0}\n            y={0}\n            className={classes.rulerLabel}\n            textAnchor=\"start\"\n            dominantBaseline=\"middle\"\n            transform={`translate(${textXY}) rotate(${radToDeg(radians)})`}\n            style={{ fill: color }}\n          >\n            {text}\n            <title>{title || text}</title>\n          </text>\n        )\n      }\n      return (\n        <text\n          x={0}\n          y={0}\n          className={classes.rulerLabel}\n          textAnchor=\"end\"\n          dominantBaseline=\"middle\"\n          transform={`translate(${textXY}) rotate(${radToDeg(radians) + 180})`}\n          style={{ fill: color }}\n        >\n          {text}\n          <title>{title || text}</title>\n        </text>\n      )\n    }\n\n    // if you get here there is no room for the text at all\n    return null\n  },\n)\n\nconst RegionRulerArc = observer(({ model, slice }) => {\n  const theme = useTheme()\n  const { radiusPx } = model\n  const { region, endRadians, startRadians } = slice\n  const centerRadians = (endRadians + startRadians) / 2\n  const widthPx = (endRadians - startRadians) * radiusPx\n  const session = getSession(model)\n  let color\n  const assembly = session.assemblyManager.get(slice.region.assemblyName)\n  if (assembly) {\n    color = assembly.getRefNameColor(region.refName)\n  }\n  if (color) {\n    try {\n      color = makeContrasting(color, theme.palette.background.paper)\n    } catch (error) {\n      color = theme.palette.text.primary\n    }\n  } else {\n    color = theme.palette.text.primary\n  }\n\n  // TODO: slice flipping\n  return (\n    <>\n      <RulerLabel\n        text={region.refName}\n        view={model}\n        maxWidthPx={widthPx}\n        radians={centerRadians}\n        radiusPx={radiusPx}\n        color={color}\n      />\n      <path\n        d={sliceArcPath(slice, radiusPx + 1, region.start, region.end)}\n        stroke={color}\n        strokeWidth={2}\n        fill=\"none\"\n      >\n        <title>{region.refName}</title>\n      </path>\n    </>\n  )\n})\n\nconst CircularRuler = observer(function Ruler({ model, slice }) {\n  if (slice.region.elided) {\n    return (\n      <ElisionRulerArc\n        key={assembleLocString(slice.region.regions[0])}\n        model={model}\n        slice={slice}\n      />\n    )\n  }\n  return (\n    <RegionRulerArc\n      key={assembleLocString(slice.region)}\n      model={model}\n      slice={slice}\n    />\n  )\n})\n\nexport default CircularRuler\n","import React, { useState } from 'react'\nimport { observer } from 'mobx-react'\n\nimport ZoomOut from '@material-ui/icons/ZoomOut'\nimport ZoomIn from '@material-ui/icons/ZoomIn'\nimport RotateLeft from '@material-ui/icons/RotateLeft'\nimport RotateRight from '@material-ui/icons/RotateRight'\nimport LockOutline from '@material-ui/icons/LockOutlined'\nimport LockOpen from '@material-ui/icons/LockOpen'\nimport { TrackSelector as TrackSelectorIcon } from '@jbrowse/core/ui/Icons'\n\n// material-ui stuff\nimport {\n  Button,\n  Container,\n  Grid,\n  IconButton,\n  MenuItem,\n  TextField,\n  makeStyles,\n} from '@material-ui/core'\n\nimport { grey } from '@material-ui/core/colors'\n\nimport { ResizeHandle } from '@jbrowse/core/ui'\nimport { assembleLocString, getSession } from '@jbrowse/core/util'\nimport Ruler from './Ruler'\n\nconst dragHandleHeight = 3\n\nconst useStyles = makeStyles(theme => {\n  return {\n    root: {\n      position: 'relative',\n      marginBottom: theme.spacing(1),\n      overflow: 'hidden',\n      background: 'white',\n    },\n    scroller: {\n      overflow: 'auto',\n    },\n    sliceRoot: {\n      background: 'none',\n      // background: theme.palette.background.paper,\n      boxSizing: 'content-box',\n      display: 'block',\n    },\n    iconButton: {\n      padding: '4px',\n      margin: '0 2px 0 2px',\n    },\n    controls: {\n      overflow: 'hidden',\n      whiteSpace: 'nowrap',\n      position: 'absolute',\n      background: grey[200],\n      boxSizing: 'border-box',\n      borderRight: '1px solid #a2a2a2',\n      borderBottom: '1px solid #a2a2a2',\n      left: 0,\n      top: 0,\n    },\n    importFormContainer: {\n      marginBottom: theme.spacing(4),\n    },\n  }\n})\n\nconst Slices = observer(({ model }) => {\n  return (\n    <>\n      <>\n        {model.staticSlices.map(slice => {\n          return (\n            <Ruler\n              key={assembleLocString(\n                slice.region.elided ? slice.region.regions[0] : slice.region,\n              )}\n              model={model}\n              slice={slice}\n            />\n          )\n        })}\n      </>\n      <>\n        {model.tracks.map(track => {\n          const display = track.displays[0]\n          return (\n            <display.RenderingComponent\n              key={display.id}\n              display={display}\n              view={model}\n            />\n          )\n        })}\n      </>\n    </>\n  )\n})\n\nconst Controls = observer(({ model, showingFigure }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.controls}>\n      <IconButton\n        onClick={model.zoomOutButton}\n        className={classes.iconButton}\n        title={model.lockedFitToWindow ? 'unlock to zoom out' : 'zoom out'}\n        disabled={\n          !showingFigure || model.atMaxBpPerPx || model.lockedFitToWindow\n        }\n        color=\"secondary\"\n      >\n        <ZoomOut />\n      </IconButton>\n\n      <IconButton\n        onClick={model.zoomInButton}\n        className={classes.iconButton}\n        title=\"zoom in\"\n        disabled={!showingFigure || model.atMinBpPerPx}\n        color=\"secondary\"\n      >\n        <ZoomIn />\n      </IconButton>\n\n      <IconButton\n        onClick={model.rotateCounterClockwiseButton}\n        className={classes.iconButton}\n        title=\"rotate counter-clockwise\"\n        disabled={!showingFigure}\n        color=\"secondary\"\n      >\n        <RotateLeft />\n      </IconButton>\n\n      <IconButton\n        onClick={model.rotateClockwiseButton}\n        className={classes.iconButton}\n        title=\"rotate clockwise\"\n        disabled={!showingFigure}\n        color=\"secondary\"\n      >\n        <RotateRight />\n      </IconButton>\n\n      <IconButton\n        onClick={model.toggleFitToWindowLock}\n        className={classes.iconButton}\n        title={\n          model.lockedFitToWindow\n            ? 'locked model to window size'\n            : 'unlocked model to zoom further'\n        }\n        disabled={model.tooSmallToLock}\n        color=\"secondary\"\n      >\n        {model.lockedFitToWindow ? <LockOutline /> : <LockOpen />}\n      </IconButton>\n\n      {model.hideTrackSelectorButton ? null : (\n        <IconButton\n          onClick={model.activateTrackSelector}\n          title=\"Open track selector\"\n          data-testid=\"circular_track_select\"\n          color=\"secondary\"\n        >\n          <TrackSelectorIcon />\n        </IconButton>\n      )}\n    </div>\n  )\n})\n\nconst ImportForm = observer(({ model }) => {\n  const classes = useStyles()\n  const [selectedAssemblyIdx, setSelectedAssemblyIdx] = useState(0)\n  const { assemblyNames, assemblyManager } = getSession(model)\n  const assemblyError = assemblyNames.length ? '' : 'No configured assemblies'\n  const assembly = assemblyManager.get(assemblyNames[selectedAssemblyIdx])\n  const regions = assembly?.regions || []\n\n  function onAssemblyChange(event) {\n    setSelectedAssemblyIdx(Number(event.target.value))\n  }\n\n  function onOpenClick() {\n    model.setDisplayedRegions(regions)\n  }\n\n  return (\n    <>\n      <Container className={classes.importFormContainer}>\n        <Grid container spacing={1} justify=\"center\" alignItems=\"center\">\n          <Grid item>\n            <TextField\n              select\n              value={\n                assemblyNames[selectedAssemblyIdx] && !assemblyError\n                  ? selectedAssemblyIdx\n                  : ''\n              }\n              onChange={onAssemblyChange}\n              helperText={assemblyError || 'Select assembly to view'}\n              error={!!assemblyError}\n              disabled={!!assemblyError}\n              margin=\"normal\"\n            >\n              {assemblyNames.map((name, idx) => (\n                <MenuItem key={name} value={idx}>\n                  {name}\n                </MenuItem>\n              ))}\n            </TextField>\n          </Grid>\n          <Grid item>\n            <Button\n              disabled={!(regions && regions.length)}\n              onClick={onOpenClick}\n              variant=\"contained\"\n              color=\"primary\"\n            >\n              {regions.length ? 'Open' : 'Loading…'}\n            </Button>\n          </Grid>\n        </Grid>\n      </Container>\n    </>\n  )\n})\n\nconst CircularView = observer(({ model }) => {\n  const classes = useStyles()\n  const initialized =\n    !!model.displayedRegions.length && model.figureWidth && model.figureHeight\n\n  const showImportForm = !initialized && !model.disableImportForm\n  const showFigure = initialized && !showImportForm\n\n  return (\n    <div\n      className={classes.root}\n      style={{\n        width: model.width,\n        height: model.height,\n      }}\n      data-testid={model.id}\n    >\n      {model.error ? (\n        <p style={{ color: 'red' }}>{model.error.message}</p>\n      ) : (\n        <>\n          {showImportForm ? <ImportForm model={model} /> : null}\n          <>\n            {!showFigure ? null : (\n              <div\n                className={classes.scroller}\n                style={{\n                  width: model.width,\n                  height: model.height,\n                }}\n              >\n                <div\n                  className={classes.rotator}\n                  style={{\n                    transform: [`rotate(${model.offsetRadians}rad)`].join(' '),\n                    transition: 'transform 0.5s',\n                    transformOrigin: model.centerXY\n                      .map(x => `${x}px`)\n                      .join(' '),\n                  }}\n                >\n                  <svg\n                    style={{\n                      position: 'absolute',\n                      left: 0,\n                      top: 0,\n                    }}\n                    className={classes.sliceRoot}\n                    width={`${model.figureWidth}px`}\n                    height={`${model.figureHeight}px`}\n                    version=\"1.1\"\n                  >\n                    <g transform={`translate(${model.centerXY})`}>\n                      <Slices model={model} />\n                    </g>\n                  </svg>\n                </div>\n              </div>\n            )}\n            <Controls model={model} showingFigure={showFigure} />\n            {model.hideVerticalResizeHandle ? null : (\n              <ResizeHandle\n                onDrag={model.resizeHeight}\n                style={{\n                  height: dragHandleHeight,\n                  position: 'absolute',\n                  bottom: 0,\n                  left: 0,\n                  background: '#ccc',\n                  boxSizing: 'border-box',\n                  borderTop: '1px solid #fafafa',\n                }}\n              />\n            )}\n          </>\n        </>\n      )}\n    </div>\n  )\n})\n\nexport default CircularView\n"],"names":["findCircleIntersectionX","y","cx","cy","r","resultArray","d","Math","abs","push","solution","sqrt","findCircleIntersectionY","x","cartesianToTheta","theta","atan","PI","cartesianToPolar","rho","twoPi","thetaRangesOverlap","r1start","r1length","r2start","r2length","viewportVisibleSection","viewSides","circleCenter","circleRadius","viewL","viewR","viewT","viewB","centerIsInsideViewport","vertices","maxRho","Infinity","i","length","min","reflect","rhoMin","rhoMax","thetaMin","thetaMax","vx","vy","Slice","view","region","currentRadianOffset","radianWidth","bpPerRadian","key","assembleLocString","offsetRadians","flipped","startRadians","endRadians","widthBp","Object","freeze","bp","radiusPx","offsetBp","elided","end","start","totalRadians","polarToCartesian","objectFromEntries","entries","calculateStaticSlices","self","slices","elidedRegions","spacingPx","pxPerRadian","sliceIsVisible","slice","visibleSection","visibleThetaMin","visibleThetaMax","CircularView","pluginManager","minHeight","minWidth","defaultHeight","types","compose","BaseViewModel","model","type","literal","bpPerPx","tracks","array","pluggableMstType","hideVerticalResizeHandle","hideTrackSelectorButton","lockedFitToWindow","disableImportForm","height","optional","refinement","number","n","minimumRadiusPx","paddingPx","lockedPaddingPx","minVisibleWidth","minimumBlockWidth","displayedRegions","Region","scrollX","scrollY","trackSelectorType","width","views","staticSlices","visibleStaticSlices","filter","bind","centerXY","circumferencePx","elidedBp","totalBp","total","maximumRadiusPx","maxBpPerPx","minCircumferencePx","minBpPerPx","maxCircumferencePx","clamp","atMaxBpPerPx","atMinBpPerPx","tooSmallToLock","figureDimensions","figureWidth","figureHeight","visible","forEach","widthPx","lastVisible","regions","v","assemblyNames","displayedRegion","includes","assemblyName","error","undefined","actions","setWidth","newWidth","max","setHeight","newHeight","resizeHeight","distance","oldHeight","setModelViewWhenAdjust","resizeWidth","oldWidth","rotateClockwiseButton","rotateClockwise","rotateCounterClockwiseButton","rotateCounterClockwise","zoomInButton","setBpPerPx","zoomOutButton","newVal","secondCondition","closeView","getParent","removeView","setDisplayedRegions","previouslyEmpty","cast","activateTrackSelector","session","getSession","isSessionModelWithWidgets","selector","addWidget","showWidget","Error","toggleTrack","trackId","hiddenCount","hideTrack","showTrack","setError","console","initialSnapshot","trackConfigSchema","pluggableConfigSchemaType","configuration","resolveIdentifier","getRoot","trackType","getTrackType","viewType","getViewType","supportedDisplays","displayTypes","map","displayType","name","displayConf","displays","find","track","stateModel","create","addTrackConf","readConfObject","shownTracks","t","transaction","remove","toggleFitToWindowLock","lib","React","react","useState","useEffect","makeStyles","observer","useStyles","theme","offset","duration","path","strokeDasharray","strokeDashoffset","animation","stroke","palette","primary","light","secondary","tertiary","quaternary","transform","Loading","radius","renderProps","classes","shown","setShown","timeout","setTimeout","clearTimeout","id","patternTransform","patternUnits","x1","y1","x2","y2","style","strokeWidth","fill","dominantBaseline","textAnchor","className","strokeLinecap","jbrequire","errorMessage","errorBackground","errorText","DisplayError","errorPattern","String","isAlive","useRef","MobxPropTypes","PropTypes","unmountComponentAtNode","hydrate","rIC","RpcRenderedSvgGroup","data","html","filled","renderingComponent","ssrContainerNode","domNode","current","doHydrate","innerHTML","display","mainThreadRendering","createElement","propTypes","observableObject","isRequired","load","ChordDisplayLoadingFactory","ChordDisplayErrorFactory","RpcRenderedSvgGroupF","BaseChordDisplay","runtime","exports","Op","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","value","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","context","Context","_invoke","makeInvokeMethod","tryCatch","fn","arg","call","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","constructor","displayName","defineIteratorMethods","method","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","__await","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","then","unwrapped","previousPromise","enqueue","callInvokeWithMethodAndArg","async","Promise","iter","next","done","state","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","info","resultName","nextLoc","toString","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","keys","object","reverse","pop","iterable","iteratorMethod","isNaN","skipTempReset","prev","charAt","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","Function","getRpcSessionId","getContainingView","renderReactionData","rendererType","rpcManager","a","renderArgs","adapterConfig","JSON","parse","stringify","blockDefinitions","sessionId","renderReactionEffect","props","signal","cannotBeRenderedReason","message","isCompatibleWithRenderer","renderInClient","ReactComponent","BaseChordDisplayModel","BaseDisplay","bezierRadiusRatio","maybe","string","reactElement","refNameMap","getEnv","onChordClick","feature","getConf","origSlices","renamed","refName","getParentRenderProps","rpcDriverName","displayModel","bezierRadius","ThisRendererType","getRendererType","rendererTypeName","renderer","CircularChordRendererType","selectedFeatureId","selection","isFeature","renderStarted","renderSuccess","renderError","setRefNameMap","renderReactionFactory","afterAttach","makeAbortableReaction","fireImmediately","getTrackAssemblyNames","parentTrack","adapter","assemblyManager","getRefNameMapForAdapter","baseChordDisplayConfig","ConfigurationSchema","description","defaultValue","contextVariable","explicitIdentifier","CircularViewPlugin","addViewType","ViewType","lazy","stateModelFactory","isAbstractMenuManager","rootModel","appendToSubMenu","label","icon","DataUsageIcon","onClick","addView","Plugin","rulerLabel","fontSize","fontWeight","lineHeight","letterSpacing","sliceArcPath","startBase","endBase","startXY","bpToXY","endXY","largeArc","sweepFlag","join","ElisionRulerArc","useTheme","modelRadiusPx","centerRadians","regionCountString","Number","toLocaleString","text","RulerLabel","maxWidthPx","radians","title","color","textXY","radToDeg","overallRotation","RegionRulerArc","assembly","get","getRefNameColor","makeContrasting","background","paper","CircularRuler","Ruler","dragHandleHeight","root","position","marginBottom","spacing","overflow","scroller","sliceRoot","boxSizing","iconButton","padding","margin","controls","whiteSpace","grey","borderRight","borderBottom","left","top","importFormContainer","Slices","Controls","showingFigure","IconButton","TrackSelectorIcon","ImportForm","selectedAssemblyIdx","setSelectedAssemblyIdx","assemblyError","onAssemblyChange","event","target","onOpenClick","Container","Grid","TextField","idx","MenuItem","Button","initialized","showImportForm","showFigure","rotator","transition","transformOrigin","ResizeHandle","bottom","borderTop"],"mappings":"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"}