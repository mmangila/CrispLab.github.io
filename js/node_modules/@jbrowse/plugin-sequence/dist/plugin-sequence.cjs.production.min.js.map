{"version":3,"file":"plugin-sequence.cjs.production.min.js","sources":["../src/BgzipFastaAdapter/configSchema.ts","../src/ChromSizesAdapter/configSchema.ts","../src/DivSequenceRenderer/components/DivSequenceRendering.tsx","../src/DivSequenceRenderer/configSchema.ts","../src/IndexedFastaAdapter/configSchema.ts","../src/LinearReferenceSequenceDisplay/configSchema.ts","../src/TwoBitAdapter/configSchema.ts","../src/GCContentAdapter/configSchema.ts","../src/GCContentAdapter/index.ts","../src/index.ts","../src/referenceSeqTrackConfig.ts","../src/LinearReferenceSequenceDisplay/model.ts","../../../node_modules/regenerator-runtime/runtime.js","../src/GCContentAdapter/GCContentAdapter.ts","../src/TwoBitAdapter/TwoBitAdapter.ts","../src/ChromSizesAdapter/ChromSizesAdapter.ts","../src/IndexedFastaAdapter/IndexedFastaAdapter.ts","../src/BgzipFastaAdapter/BgzipFastaAdapter.ts"],"sourcesContent":["import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default ConfigurationSchema(\n  'BgzipFastaAdapter',\n  {\n    fastaLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/seq.fa.gz' },\n    },\n    faiLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/seq.fa.gz.fai' },\n    },\n    gziLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/seq.fa.gz.gzi' },\n    },\n  },\n  { explicitlyTyped: true },\n)\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default ConfigurationSchema(\n  'ChromSizesAdapter',\n  {\n    chromSizesLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/species.chrom.sizes' },\n    },\n  },\n  { explicitlyTyped: true },\n)\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { AnyConfigurationModel } from '@jbrowse/core/configuration/configurationSchema'\nimport { contrastingTextColor } from '@jbrowse/core/util/color'\nimport { Feature } from '@jbrowse/core/util/simpleFeature'\nimport { Region } from '@jbrowse/core/util/types'\nimport { createJBrowseTheme } from '@jbrowse/core/ui'\nimport { observer } from 'mobx-react'\nimport React from 'react'\nimport {\n  bpSpanPx,\n  revcom,\n  complement,\n  defaultStarts,\n  defaultStops,\n  defaultCodonTable,\n  generateCodonTable,\n} from '@jbrowse/core/util'\n\ninterface MyProps {\n  exportSVG?: { rasterizeLayers: boolean }\n  features: Map<string, Feature>\n  regions: Region[]\n  bpPerPx: number\n  config: AnyConfigurationModel\n  highResolutionScaling: number\n  theme: any\n  showForward: boolean\n  showReverse: boolean\n  showTranslation: boolean\n}\n\nfunction Translation(props: {\n  codonTable: any\n  seq: string\n  frame: number\n  bpPerPx: number\n  region: Region\n  reverse?: boolean\n  height: number\n  y: number\n  theme?: any\n}) {\n  const {\n    codonTable,\n    seq,\n    frame,\n    bpPerPx,\n    region,\n    height,\n    y,\n    reverse = false,\n    theme,\n  } = props\n  const scale = bpPerPx\n\n  // the tilt variable normalizes the frame to where we are starting from,\n  // which increases consistency across blocks\n  const tilt = 3 - (region.start % 3)\n\n  // the effectiveFrame incorporates tilt and the frame to say what the\n  // effective frame that is plotted. The +3 is for when frame is -2 and this\n  // can otherwise result in effectiveFrame -1\n  const effectiveFrame = (frame + tilt + 3) % 3\n\n  const seqSliced = seq.slice(effectiveFrame)\n\n  const translated: { letter: string; codon: string }[] = []\n  for (let i = 0; i < seqSliced.length; i += 3) {\n    const codon = seqSliced.slice(i, i + 3)\n    const normalizedCodon = reverse ? revcom(codon) : codon\n    const aminoAcid = codonTable[normalizedCodon] || ''\n    translated.push({ letter: aminoAcid, codon: normalizedCodon.toUpperCase() })\n  }\n\n  const w = (1 / scale) * 3\n  const drop = region.start === 0 ? 0 : w\n  const render = 1 / bpPerPx >= 12\n  const width = (region.end - region.start) / bpPerPx\n\n  const map = ['#d8d8d8', '#adadad', '#8f8f8f'].reverse()\n  return (\n    <>\n      {translated.map((element, index) => {\n        const x = region.reversed\n          ? width - (w * (index + 1) + effectiveFrame / scale - drop)\n          : w * index + effectiveFrame / scale - drop\n        const { letter, codon } = element\n        return (\n          <React.Fragment key={`${index}-${letter}`}>\n            <rect\n              x={x}\n              y={y}\n              width={\n                render ? w : w + 0.7 /* small fudge factor when zoomed out*/\n              }\n              height={height}\n              stroke={render ? '#555' : 'none'}\n              fill={\n                defaultStarts.includes(codon)\n                  ? theme.palette.startCodon\n                  : defaultStops.includes(codon)\n                  ? theme.palette.stopCodon\n                  : map[Math.abs(frame)]\n              }\n            />\n            {render ? (\n              <text\n                x={x + w / 2}\n                y={y + height / 2}\n                dominantBaseline=\"middle\"\n                textAnchor=\"middle\"\n              >\n                {letter}\n              </text>\n            ) : null}\n          </React.Fragment>\n        )\n      })}\n    </>\n  )\n}\n\nfunction DNA(props: {\n  seq: string\n  theme: any\n  bpPerPx: number\n  height: number\n  region: Region\n  feature: Feature\n  y: number\n}) {\n  const { bpPerPx, region, feature, theme, height, seq, y } = props\n  const render = 1 / bpPerPx >= 12\n\n  const [leftPx, rightPx] = bpSpanPx(\n    feature.get('start'),\n    feature.get('end'),\n    region,\n    bpPerPx,\n  )\n  const reverse = region.reversed\n  const len = feature.get('end') - feature.get('start')\n  const w = Math.max((rightPx - leftPx) / len, 0.8)\n\n  return (\n    <>\n      {seq.split('').map((letter, index) => {\n        const color = theme.palette.bases[letter.toUpperCase()]\n        const x = reverse ? rightPx - (index + 1) * w : leftPx + index * w\n        return (\n          <React.Fragment key={index}>\n            <rect\n              x={x}\n              y={y}\n              width={w}\n              height={height}\n              fill={color ? color.main : '#aaa'}\n              stroke={render ? '#555' : 'none'}\n            />\n            {render ? (\n              <text\n                x={x + w / 2}\n                y={y + height / 2}\n                dominantBaseline=\"middle\"\n                textAnchor=\"middle\"\n                fill={color ? contrastingTextColor(color.main) : 'black'}\n              >\n                {letter}\n              </text>\n            ) : null}\n          </React.Fragment>\n        )\n      })}\n    </>\n  )\n}\n\nconst SequenceSVG = ({\n  regions,\n  theme: configTheme,\n  features = new Map(),\n  showReverse,\n  showForward,\n  showTranslation,\n  bpPerPx,\n}: any) => {\n  const [region] = regions\n  const theme = createJBrowseTheme(configTheme)\n  const codonTable = generateCodonTable(defaultCodonTable)\n  const height = 20\n  const [feature] = [...features.values()]\n  if (!feature) {\n    return null\n  }\n  const seq: string = feature.get('seq')\n  if (!seq) {\n    return null\n  }\n\n  // incrementer for the y-position of the current sequence being rendered\n  // (applies to both translation rows and dna rows)\n  let currY = -20\n\n  return (\n    <>\n      {/* the upper translation row. if the view is reversed, the reverse\n        translation is on the top */}\n      {showTranslation && (region.reversed ? showReverse : showForward)\n        ? [2, 1, 0].map(index => (\n            <Translation\n              key={`translation-${index}`}\n              seq={seq}\n              y={(currY += 20)}\n              codonTable={codonTable}\n              frame={index}\n              bpPerPx={bpPerPx}\n              region={region}\n              theme={theme}\n              height={height}\n              reverse={region.reversed}\n            />\n          ))\n        : null}\n\n      {showForward ? (\n        <DNA\n          height={height}\n          y={(currY += 20)}\n          feature={feature}\n          region={region}\n          seq={region.reversed ? complement(seq) : seq}\n          bpPerPx={bpPerPx}\n          theme={theme}\n        />\n      ) : null}\n\n      {showReverse ? (\n        <DNA\n          height={height}\n          y={(currY += 20)}\n          feature={feature}\n          region={region}\n          seq={region.reversed ? seq : complement(seq)}\n          bpPerPx={bpPerPx}\n          theme={theme}\n        />\n      ) : null}\n\n      {/* the lower translation row. if the view is reversed, the forward\n        translation is on the bottom */}\n      {showTranslation && (region.reversed ? showForward : showReverse)\n        ? [0, -1, -2].map(index => (\n            <Translation\n              key={`rev-translation-${index}`}\n              seq={seq}\n              y={(currY += 20)}\n              codonTable={codonTable}\n              frame={index}\n              bpPerPx={bpPerPx}\n              region={region}\n              theme={theme}\n              height={height}\n              reverse={!region.reversed}\n            />\n          ))\n        : null}\n    </>\n  )\n}\n\nconst Wrapper = ({ exportSVG, width, totalHeight, children }: any) => {\n  return exportSVG ? (\n    <>{children}</>\n  ) : (\n    <svg\n      width={width}\n      height={totalHeight}\n      style={{ width, height: totalHeight }}\n    >\n      {children}\n    </svg>\n  )\n}\n\nfunction Sequence(props: MyProps) {\n  const { regions, bpPerPx } = props\n  const [region] = regions\n  const width = (region.end - region.start) / bpPerPx\n  const totalHeight = 200\n\n  return (\n    <Wrapper {...props} totalHeight={totalHeight} width={width}>\n      <SequenceSVG {...props} />\n    </Wrapper>\n  )\n}\n\nexport default observer(Sequence)\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default ConfigurationSchema(\n  'DivSequenceRenderer',\n  {\n    height: {\n      type: 'number',\n      description: 'height in pixels of each line of sequence',\n      defaultValue: 16,\n    },\n  },\n  { explicitlyTyped: true },\n)\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default ConfigurationSchema(\n  'IndexedFastaAdapter',\n  {\n    fastaLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/seq.fa' },\n    },\n    faiLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/seq.fa.fai' },\n    },\n  },\n  { explicitlyTyped: true },\n)\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { configSchema as divSequenceRendererConfigSchema } from '../DivSequenceRenderer'\n\nexport const configSchema = ConfigurationSchema(\n  'LinearReferenceSequenceDisplay',\n  { renderer: divSequenceRendererConfigSchema },\n  { explicitIdentifier: 'displayId', explicitlyTyped: true },\n)\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default ConfigurationSchema(\n  'TwoBitAdapter',\n  {\n    twoBitLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/my.2bit' },\n    },\n  },\n  { explicitlyTyped: true },\n)\n","import PluginManager from '@jbrowse/core/PluginManager'\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default (pluginManager: PluginManager) => {\n  return ConfigurationSchema(\n    'GCContentAdapter',\n    {\n      sequenceAdapter: pluginManager.pluggableConfigSchemaType('adapter'),\n    },\n    { explicitlyTyped: true },\n  )\n}\n","import PluginManager from '@jbrowse/core/PluginManager'\nimport configSchemaF from './configSchema'\n\nexport default (pluginManager: PluginManager) => {\n  return {\n    configSchema: pluginManager.load(configSchemaF),\n    getAdapterClass: () => import('./GCContentAdapter').then(r => r.default),\n  }\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\nimport { Region } from '@jbrowse/core/util/types'\nimport { createBaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\nimport FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\nimport TrackType from '@jbrowse/core/pluggableElementTypes/TrackType'\nimport Plugin from '@jbrowse/core/Plugin'\nimport PluginManager from '@jbrowse/core/PluginManager'\nimport { BaseLinearDisplayComponent } from '@jbrowse/plugin-linear-genome-view'\nimport { configSchema as bgzipFastaAdapterConfigSchema } from './BgzipFastaAdapter'\nimport { configSchema as chromSizesAdapterConfigSchema } from './ChromSizesAdapter'\nimport {\n  configSchema as divSequenceRendererConfigSchema,\n  ReactComponent as DivSequenceRendererReactComponent,\n} from './DivSequenceRenderer'\nimport { configSchema as indexedFastaAdapterConfigSchema } from './IndexedFastaAdapter'\nimport {\n  configSchema as linearReferenceSequenceDisplayConfigSchema,\n  modelFactory as linearReferenceSequenceDisplayModelFactory,\n} from './LinearReferenceSequenceDisplay'\nimport { configSchema as twoBitAdapterConfigSchema } from './TwoBitAdapter'\nimport GCContentAdapterF from './GCContentAdapter'\nimport { createReferenceSeqTrackConfig } from './referenceSeqTrackConfig'\n\n/* adjust in both directions */\nclass DivSequenceRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  getExpandedRegion(region: Region) {\n    return {\n      ...region,\n      start: Math.max(region.start - 3, 0),\n      end: region.end + 3,\n    }\n  }\n}\n\nexport default class SequencePlugin extends Plugin {\n  name = 'SequencePlugin'\n\n  install(pluginManager: PluginManager) {\n    pluginManager.addAdapterType(\n      () =>\n        new AdapterType({\n          name: 'TwoBitAdapter',\n          configSchema: twoBitAdapterConfigSchema,\n          getAdapterClass: () =>\n            import('./TwoBitAdapter/TwoBitAdapter').then(r => r.default),\n        }),\n    )\n\n    pluginManager.addAdapterType(\n      () =>\n        new AdapterType({\n          name: 'ChromSizesAdapter',\n          configSchema: chromSizesAdapterConfigSchema,\n          getAdapterClass: () =>\n            import('./ChromSizesAdapter/ChromSizesAdapter').then(\n              r => r.default,\n            ),\n        }),\n    )\n\n    pluginManager.addAdapterType(\n      () =>\n        new AdapterType({\n          name: 'IndexedFastaAdapter',\n          configSchema: indexedFastaAdapterConfigSchema,\n          getAdapterClass: () =>\n            import('./IndexedFastaAdapter/IndexedFastaAdapter').then(\n              r => r.default,\n            ),\n        }),\n    )\n\n    pluginManager.addAdapterType(\n      () =>\n        new AdapterType({\n          name: 'BgzipFastaAdapter',\n          configSchema: bgzipFastaAdapterConfigSchema,\n          getAdapterClass: () =>\n            import('./BgzipFastaAdapter/BgzipFastaAdapter').then(\n              r => r.default,\n            ),\n        }),\n    )\n\n    pluginManager.addAdapterType(\n      () =>\n        new AdapterType({\n          name: 'GCContentAdapter',\n          ...pluginManager.load(GCContentAdapterF),\n        }),\n    )\n    pluginManager.addTrackType(() => {\n      const configSchema = createReferenceSeqTrackConfig(pluginManager)\n\n      return new TrackType({\n        name: 'ReferenceSequenceTrack',\n        configSchema,\n        stateModel: createBaseTrackModel(\n          pluginManager,\n          'ReferenceSequenceTrack',\n          configSchema,\n        ),\n      })\n    })\n\n    pluginManager.addDisplayType(() => {\n      const stateModel = linearReferenceSequenceDisplayModelFactory(\n        linearReferenceSequenceDisplayConfigSchema,\n      )\n      return {\n        name: 'LinearReferenceSequenceDisplay',\n        configSchema: linearReferenceSequenceDisplayConfigSchema,\n        stateModel,\n        trackType: 'ReferenceSequenceTrack',\n        viewType: 'LinearGenomeView',\n        ReactComponent: BaseLinearDisplayComponent,\n      }\n    })\n\n    pluginManager.addRendererType(\n      () =>\n        new DivSequenceRenderer({\n          name: 'DivSequenceRenderer',\n          ReactComponent: DivSequenceRendererReactComponent,\n          configSchema: divSequenceRendererConfigSchema,\n          pluginManager,\n        }),\n    )\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { types } from 'mobx-state-tree'\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport PluginManager from '@jbrowse/core/PluginManager'\n\n/*\nNote: this is primarily a copy of createBaseTrackConfig, except with a subset\nof the config slots, to avoid including fields that don't make sense for the\nReferenceSequenceTrack\n*/\nexport function createReferenceSeqTrackConfig(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'ReferenceSequenceTrack',\n    {\n      adapter: pluginManager.pluggableConfigSchemaType('adapter'),\n      displays: types.array(pluginManager.pluggableConfigSchemaType('display')),\n      metadata: {\n        type: 'frozen',\n        description: 'anything to add about this track',\n        defaultValue: {},\n      },\n    },\n    {\n      preProcessSnapshot: s => {\n        const snap = JSON.parse(JSON.stringify(s))\n        const displayTypes = new Set()\n        const { displays = [] } = snap\n        if (snap.trackId !== 'placeholderId') {\n          // Gets the displays on the track snapshot and the possible displays\n          // from the track type and adds any missing possible displays to the\n          // snapshot\n          displays.forEach((d: any) => d && displayTypes.add(d.type))\n          const trackType = pluginManager.getTrackType(snap.type)\n          trackType.displayTypes.forEach(displayType => {\n            if (!displayTypes.has(displayType.name)) {\n              displays.push({\n                displayId: `${snap.trackId}-${displayType.name}`,\n                type: displayType.name,\n              })\n            }\n          })\n        }\n        return { ...snap, displays }\n      },\n      explicitIdentifier: 'trackId',\n      explicitlyTyped: true,\n      actions: (self: any) => ({\n        addDisplayConf(displayConf: { type: string; displayId: string }) {\n          const { type } = displayConf\n          if (!type) {\n            throw new Error(`unknown display type ${type}`)\n          }\n          const display = self.displays.find(\n            (d: any) => d && d.displayId === displayConf.displayId,\n          )\n          if (display) {\n            return display\n          }\n          const length = self.displays.push(displayConf)\n          return self.displays[length - 1]\n        },\n      }),\n    },\n  )\n}\n","import { types } from 'mobx-state-tree'\nimport {\n  BaseLinearDisplay,\n  LinearGenomeViewModel,\n} from '@jbrowse/plugin-linear-genome-view'\nimport { ConfigurationReference } from '@jbrowse/core/configuration'\nimport { getParentRenderProps } from '@jbrowse/core/util/tracks'\nimport { AnyConfigurationSchemaType } from '@jbrowse/core/configuration/configurationSchema'\nimport { getContainingView } from '@jbrowse/core/util'\n\nexport function modelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearReferenceSequenceDisplay',\n      BaseLinearDisplay,\n      types.model({\n        type: types.literal('LinearReferenceSequenceDisplay'),\n        configuration: ConfigurationReference(configSchema),\n        showForward: types.optional(types.boolean, true),\n        showReverse: types.optional(types.boolean, true),\n        showTranslation: types.optional(types.boolean, true),\n        height: 180,\n      }),\n    )\n    .views(self => ({\n      get renderProps() {\n        const { showForward, showReverse, showTranslation } = self\n        return {\n          ...self.composedRenderProps,\n          ...getParentRenderProps(self),\n          rpcDriverName: self.rpcDriverName,\n          config: self.configuration.renderer,\n          showForward,\n          showReverse,\n          showTranslation,\n        }\n      },\n      regionCannotBeRendered(/* region */) {\n        const view = getContainingView(self) as LinearGenomeViewModel\n        if (view && view.bpPerPx >= 1) {\n          return 'Zoom in to see sequence'\n        }\n        return undefined\n      },\n\n      get rendererTypeName() {\n        return self.configuration.renderer.type\n      },\n    }))\n    .actions(self => ({\n      toggleShowForward() {\n        self.showForward = !self.showForward\n      },\n      toggleShowReverse() {\n        self.showReverse = !self.showReverse\n      },\n      toggleShowTranslation() {\n        self.showTranslation = !self.showTranslation\n      },\n    }))\n    .views(self => ({\n      get trackMenuItems() {\n        return [\n          {\n            label: 'Show forward',\n            type: 'checkbox',\n            checked: self.showForward,\n            onClick: () => {\n              self.toggleShowForward()\n            },\n          },\n          {\n            label: 'Show reverse',\n            type: 'checkbox',\n            checked: self.showReverse,\n            onClick: () => {\n              self.toggleShowReverse()\n            },\n          },\n          {\n            label: 'Show translation',\n            type: 'checkbox',\n            checked: self.showTranslation,\n            onClick: () => {\n              self.toggleShowTranslation()\n            },\n          },\n        ]\n      },\n    }))\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","import {\n  BaseFeatureDataAdapter,\n  BaseOptions,\n} from '@jbrowse/core/data_adapters/BaseAdapter'\nimport { Region } from '@jbrowse/core/util/types'\nimport { ObservableCreate } from '@jbrowse/core/util/rxjs'\nimport SimpleFeature, { Feature } from '@jbrowse/core/util/simpleFeature'\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport { toArray } from 'rxjs/operators'\n\nexport default class extends BaseFeatureDataAdapter {\n  private windowSize = 1000\n\n  private windowDelta = 1000\n\n  private gcMode = 'content'\n\n  public static capabilities = ['hasLocalStats']\n\n  public async configure() {\n    // instantiate the sequence adapter\n    const sequenceAdapter = readConfObject(this.config, 'sequenceAdapter')\n\n    const dataAdapter = await this.getSubAdapter?.(sequenceAdapter)\n    if (!dataAdapter) {\n      throw new Error('Error getting subadapter')\n    }\n    return dataAdapter.dataAdapter as BaseFeatureDataAdapter\n  }\n\n  public async getRefNames() {\n    const sequenceAdapter = await this.configure()\n    return sequenceAdapter.getRefNames()\n  }\n\n  /**\n   * Fetch features for a certain region\n   * @param param -\n   * @returns Observable of Feature objects in the region\n   */\n  public getFeatures(query: Region, opts: BaseOptions) {\n    this.windowSize = 1000\n    this.windowDelta = 1000\n    this.gcMode = 'content'\n    return ObservableCreate<Feature>(async observer => {\n      const sequenceAdapter = await this.configure()\n      const hw = this.windowSize === 1 ? 1 : this.windowSize / 2 // Half the window size\n      const f = this.windowSize === 1\n\n      let { start: queryStart, end: queryEnd } = query\n      queryStart = Math.max(0, queryStart - hw)\n      queryEnd += hw\n\n      if (queryEnd < 0 || queryStart > queryEnd) {\n        observer.complete()\n        return\n      }\n\n      const ret = sequenceAdapter.getFeatures(\n        { ...query, start: queryStart, end: queryEnd },\n        opts,\n      )\n      const [feat] = await ret.pipe(toArray()).toPromise()\n      const residues = feat.get('seq')\n\n      for (let i = hw; i < residues.length - hw; i += this.windowDelta) {\n        const r = f ? residues[i] : residues.slice(i - hw, i + hw)\n        let nc = 0\n        let ng = 0\n        let len = 0\n        for (let j = 0; j < r.length; j++) {\n          if (r[j] === 'c' || r[j] === 'C') {\n            nc++\n          } else if (r[j] === 'g' || r[j] === 'G') {\n            ng++\n          }\n          if (r[j] !== 'N') {\n            len++\n          }\n        }\n        const pos = queryStart\n        let score\n        if (this.gcMode === 'content') {\n          score = (ng + nc) / (len || 1)\n        } else if (this.gcMode === 'skew') {\n          score = (ng - nc) / (ng + nc || 1)\n        }\n\n        // if (r[Math.floor(r.length / 2)] !== 'N') {\n        observer.next(\n          new SimpleFeature({\n            uniqueId: `${this.id}_${pos + i}`,\n            start: pos + i,\n            end: pos + i + this.windowDelta,\n            score,\n          }),\n        )\n        // }\n      }\n      observer.complete()\n    })\n  }\n\n  /**\n   * called to provide a hint that data tied to a certain region\n   * will not be needed for the forseeable future and can be purged\n   * from caches, etc\n   */\n  public freeResources(/* { region } */): void {}\n}\n","import {\n  BaseFeatureDataAdapter,\n  SequenceAdapter,\n} from '@jbrowse/core/data_adapters/BaseAdapter'\nimport { NoAssemblyRegion } from '@jbrowse/core/util/types'\nimport { openLocation } from '@jbrowse/core/util/io'\nimport { ObservableCreate } from '@jbrowse/core/util/rxjs'\nimport SimpleFeature, { Feature } from '@jbrowse/core/util/simpleFeature'\nimport { TwoBitFile } from '@gmod/twobit'\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport { Instance } from 'mobx-state-tree'\n\nimport configSchema from './configSchema'\n\nexport default class TwoBitAdapter\n  extends BaseFeatureDataAdapter\n  implements SequenceAdapter {\n  private twobit: typeof TwoBitFile\n\n  constructor(config: Instance<typeof configSchema>) {\n    super(config)\n    const twoBitOpts = {\n      filehandle: openLocation(readConfObject(config, 'twoBitLocation')),\n    }\n\n    this.twobit = new TwoBitFile(twoBitOpts)\n  }\n\n  public getRefNames() {\n    return this.twobit.getSequenceNames()\n  }\n\n  public async getRegions(): Promise<NoAssemblyRegion[]> {\n    const refSizes = await this.twobit.getSequenceSizes()\n    return Object.keys(refSizes).map(\n      (refName: string): NoAssemblyRegion => ({\n        refName,\n        start: 0,\n        end: refSizes[refName],\n      }),\n    )\n  }\n\n  /**\n   * Fetch features for a certain region\n   * @param param -\n   * @returns Observable of Feature objects in the region\n   */\n  public getFeatures({ refName, start, end }: NoAssemblyRegion) {\n    return ObservableCreate<Feature>(async observer => {\n      const size = await this.twobit.getSequenceSize(refName)\n      const regionEnd = size !== undefined ? Math.min(size, end) : end\n      const seq: string = await this.twobit.getSequence(\n        refName,\n        start,\n        regionEnd,\n      )\n      if (seq) {\n        observer.next(\n          new SimpleFeature({\n            id: `${refName} ${start}-${regionEnd}`,\n            data: { refName, start, end: regionEnd, seq },\n          }),\n        )\n      }\n      observer.complete()\n    })\n  }\n\n  /**\n   * called to provide a hint that data tied to a certain region\n   * will not be needed for the forseeable future and can be purged\n   * from caches, etc\n   */\n  public freeResources(/* { region } */): void {}\n}\n","import {\n  RegionsAdapter,\n  BaseAdapter,\n} from '@jbrowse/core/data_adapters/BaseAdapter'\nimport { FileLocation } from '@jbrowse/core/util/types'\nimport { openLocation } from '@jbrowse/core/util/io'\nimport { GenericFilehandle } from 'generic-filehandle'\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport { Instance } from 'mobx-state-tree'\nimport MyConfigSchema from './configSchema'\n\nexport default class extends BaseAdapter implements RegionsAdapter {\n  // the map of refSeq to length\n  protected refSeqs: Promise<Record<string, number>>\n\n  protected source: string\n\n  public constructor(config: Instance<typeof MyConfigSchema>) {\n    super(config)\n    const chromSizesLocation = readConfObject(config, 'chromSizesLocation')\n    if (!chromSizesLocation) {\n      throw new Error('must provide chromSizesLocation')\n    }\n    const file = openLocation(chromSizesLocation as FileLocation)\n    this.source = file.toString()\n    this.refSeqs = this.init(file)\n  }\n\n  private async init(file: GenericFilehandle) {\n    const data = (await file.readFile('utf8')) as string\n    const refSeqs: { [key: string]: number } = {}\n    if (!data.length) {\n      throw new Error(`Could not read file ${file.toString()}`)\n    }\n    data.split('\\n').forEach((line: string) => {\n      if (line.length) {\n        const [name, length] = line.split('\\t')\n        refSeqs[name] = +length\n      }\n    })\n    return refSeqs\n  }\n\n  public async getRegions() {\n    const refSeqs = await this.refSeqs\n    return Object.keys(refSeqs).map(refName => ({\n      refName,\n      start: 0,\n      end: refSeqs[refName],\n    }))\n  }\n\n  public freeResources(/* { region } */): void {}\n}\n","import { IndexedFasta } from '@gmod/indexedfasta'\nimport {\n  BaseFeatureDataAdapter,\n  SequenceAdapter,\n} from '@jbrowse/core/data_adapters/BaseAdapter'\nimport { FileLocation, NoAssemblyRegion } from '@jbrowse/core/util/types'\nimport { openLocation } from '@jbrowse/core/util/io'\nimport { ObservableCreate } from '@jbrowse/core/util/rxjs'\nimport SimpleFeature, { Feature } from '@jbrowse/core/util/simpleFeature'\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport { AnyConfigurationModel } from '@jbrowse/core/configuration/configurationSchema'\nimport AbortablePromiseCache from 'abortable-promise-cache'\nimport LRU from '@jbrowse/core/util/QuickLRU'\n\nexport default class extends BaseFeatureDataAdapter implements SequenceAdapter {\n  protected fasta: typeof IndexedFasta\n\n  private seqCache = new AbortablePromiseCache({\n    cache: new LRU({ maxSize: 200 }),\n    fill: async (\n      args: { refName: string; start: number; end: number },\n      // abortSignal?: AbortSignal,\n    ) => {\n      const { refName, start, end } = args\n      return this.fasta.getSequence(refName, start, end)\n    },\n  })\n\n  public constructor(config: AnyConfigurationModel) {\n    super(config)\n    const fastaLocation = readConfObject(config, 'fastaLocation')\n    const faiLocation = readConfObject(config, 'faiLocation')\n    if (!fastaLocation) {\n      throw new Error('must provide fastaLocation')\n    }\n    if (!faiLocation) {\n      throw new Error('must provide faiLocation')\n    }\n    const fastaOpts = {\n      fasta: openLocation(fastaLocation as FileLocation),\n      fai: openLocation(faiLocation as FileLocation),\n    }\n\n    this.fasta = new IndexedFasta(fastaOpts)\n  }\n\n  public getRefNames() {\n    return this.fasta.getSequenceNames()\n  }\n\n  public async getRegions(): Promise<NoAssemblyRegion[]> {\n    const seqSizes = await this.fasta.getSequenceSizes()\n    return Object.keys(seqSizes).map(\n      (refName: string): NoAssemblyRegion => ({\n        refName,\n        start: 0,\n        end: seqSizes[refName],\n      }),\n    )\n  }\n\n  /**\n   * Fetch features for a certain region\n   * @param param -\n   * @returns Observable of Feature objects in the region\n   */\n  public getFeatures({ refName, start, end }: NoAssemblyRegion) {\n    return ObservableCreate<Feature>(async observer => {\n      const size = await this.fasta.getSequenceSize(refName)\n      const regionEnd = size !== undefined ? Math.min(size, end) : end\n      const chunks = []\n      const chunkSize = 128000\n\n      const s = start - (start % chunkSize)\n      const e = end + (chunkSize - (end % chunkSize))\n      for (let chunkStart = s; chunkStart < e; chunkStart += chunkSize) {\n        const r = {\n          refName,\n          start: chunkStart,\n          end: chunkStart + chunkSize,\n        }\n        chunks.push(this.seqCache.get(JSON.stringify(r), r))\n      }\n      const seq = (await Promise.all(chunks))\n        .join('')\n        .slice(start - s)\n        .slice(0, end - start)\n      if (seq) {\n        observer.next(\n          new SimpleFeature({\n            id: `${refName} ${start}-${regionEnd}`,\n            data: { refName, start, end: regionEnd, seq },\n          }),\n        )\n      }\n      observer.complete()\n    })\n  }\n\n  /**\n   * called to provide a hint that data tied to a certain region\n   * will not be needed for the forseeable future and can be purged\n   * from caches, etc\n   */\n  public freeResources(/* { region } */): void {}\n}\n","import { BgzipIndexedFasta } from '@gmod/indexedfasta'\nimport { FileLocation } from '@jbrowse/core/util/types'\nimport { openLocation } from '@jbrowse/core/util/io'\nimport { Instance } from 'mobx-state-tree'\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport IndexedFasta from '../IndexedFastaAdapter/IndexedFastaAdapter'\nimport MyConfigSchema from './configSchema'\n\nexport default class extends IndexedFasta {\n  public constructor(config: Instance<typeof MyConfigSchema>) {\n    super(config)\n    const fastaLocation = readConfObject(config, 'fastaLocation')\n    const faiLocation = readConfObject(config, 'faiLocation')\n    const gziLocation = readConfObject(config, 'gziLocation')\n    if (!fastaLocation) {\n      throw new Error('must provide fastaLocation')\n    }\n    if (!faiLocation) {\n      throw new Error('must provide faiLocation')\n    }\n    if (!gziLocation) {\n      throw new Error('must provide gziLocation')\n    }\n    const fastaOpts = {\n      fasta: openLocation(fastaLocation as FileLocation),\n      fai: openLocation(faiLocation as FileLocation),\n      gzi: openLocation(gziLocation as FileLocation),\n    }\n\n    this.fasta = new BgzipIndexedFasta(fastaOpts)\n  }\n}\n"],"names":["ConfigurationSchema","fastaLocation","type","defaultValue","uri","faiLocation","gziLocation","explicitlyTyped","chromSizesLocation","Translation","props","codonTable","frame","bpPerPx","region","height","y","reverse","theme","scale","effectiveFrame","start","seqSliced","seq","slice","translated","i","length","codon","normalizedCodon","revcom","push","letter","toUpperCase","w","drop","render","width","end","map","React","element","index","x","reversed","Fragment","key","stroke","fill","defaultStarts","includes","palette","startCodon","defaultStops","stopCodon","Math","abs","dominantBaseline","textAnchor","DNA","feature","bpSpanPx","get","leftPx","rightPx","len","max","split","color","bases","main","contrastingTextColor","SequenceSVG","regions","configTheme","features","Map","showReverse","showForward","showTranslation","createJBrowseTheme","generateCodonTable","defaultCodonTable","values","currY","complement","Wrapper","totalHeight","children","exportSVG","style","Sequence","observer","description","configSchema","renderer","divSequenceRendererConfigSchema","explicitIdentifier","twoBitLocation","pluginManager","sequenceAdapter","pluggableConfigSchemaType","load","configSchemaF","getAdapterClass","Promise","then","r","DivSequenceRenderer","FeatureRendererType","SequencePlugin","Plugin","addAdapterType","AdapterType","name","twoBitAdapterConfigSchema","chromSizesAdapterConfigSchema","indexedFastaAdapterConfigSchema","bgzipFastaAdapterConfigSchema","GCContentAdapterF","addTrackType","adapter","displays","types","array","metadata","preProcessSnapshot","s","snap","JSON","parse","stringify","displayTypes","Set","trackId","forEach","d","add","getTrackType","displayType","has","displayId","actions","self","addDisplayConf","displayConf","Error","display","find","createReferenceSeqTrackConfig","TrackType","stateModel","createBaseTrackModel","addDisplayType","compose","BaseLinearDisplay","model","literal","configuration","ConfigurationReference","optional","views","composedRenderProps","getParentRenderProps","rpcDriverName","config","regionCannotBeRendered","view","getContainingView","toggleShowForward","toggleShowReverse","toggleShowTranslation","label","checked","onClick","linearReferenceSequenceDisplayModelFactory","linearReferenceSequenceDisplayConfigSchema","trackType","viewType","ReactComponent","BaseLinearDisplayComponent","addRendererType","DivSequenceRendererReactComponent","runtime","exports","Op","Object","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","value","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","tryLocsList","generator","create","Generator","context","Context","_invoke","state","method","arg","undefined","done","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","makeInvokeMethod","fn","call","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","Gp","defineIteratorMethods","AsyncIterator","PromiseImpl","previousPromise","callInvokeWithMethodAndArg","resolve","reject","invoke","result","__await","unwrapped","error","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","doneResult","constructor","displayName","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","async","iter","toString","keys","object","pop","skipTempReset","prev","charAt","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","Function","BaseFeatureDataAdapter","readConfObject","getSubAdapter","_this$getSubAdapter","dataAdapter","configure","getRefNames","query","opts","windowSize","windowDelta","gcMode","ObservableCreate","_this2","hw","f","queryStart","queryEnd","ret","getFeatures","pipe","toArray","toPromise","residues","nc","ng","j","pos","score","SimpleFeature","uniqueId","id","default_1","twoBitOpts","filehandle","openLocation","twobit","TwoBitFile","getSequenceNames","getSequenceSizes","refSizes","refName","getSequenceSize","regionEnd","size","min","getSequence","data","BaseAdapter","file","source","refSeqs","_this","init","readFile","line","AbortablePromiseCache","cache","LRU","maxSize","args","fasta","fastaOpts","fai","IndexedFasta","seqSizes","chunks","e","chunkStart","seqCache","all","join","gzi","BgzipIndexedFasta"],"mappings":"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"}