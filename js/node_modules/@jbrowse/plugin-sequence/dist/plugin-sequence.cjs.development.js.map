{"version":3,"file":"plugin-sequence.cjs.development.js","sources":["../src/BgzipFastaAdapter/configSchema.ts","../src/ChromSizesAdapter/configSchema.ts","../src/DivSequenceRenderer/components/DivSequenceRendering.tsx","../src/DivSequenceRenderer/configSchema.ts","../src/IndexedFastaAdapter/configSchema.ts","../src/LinearReferenceSequenceDisplay/configSchema.ts","../src/LinearReferenceSequenceDisplay/model.ts","../src/TwoBitAdapter/configSchema.ts","../src/GCContentAdapter/configSchema.ts","../src/GCContentAdapter/index.ts","../src/referenceSeqTrackConfig.ts","../src/index.ts","../../../node_modules/regenerator-runtime/runtime.js","../src/GCContentAdapter/GCContentAdapter.ts","../src/TwoBitAdapter/TwoBitAdapter.ts","../src/ChromSizesAdapter/ChromSizesAdapter.ts","../src/IndexedFastaAdapter/IndexedFastaAdapter.ts","../src/BgzipFastaAdapter/BgzipFastaAdapter.ts"],"sourcesContent":["import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default ConfigurationSchema(\n  'BgzipFastaAdapter',\n  {\n    fastaLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/seq.fa.gz' },\n    },\n    faiLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/seq.fa.gz.fai' },\n    },\n    gziLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/seq.fa.gz.gzi' },\n    },\n  },\n  { explicitlyTyped: true },\n)\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default ConfigurationSchema(\n  'ChromSizesAdapter',\n  {\n    chromSizesLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/species.chrom.sizes' },\n    },\n  },\n  { explicitlyTyped: true },\n)\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { AnyConfigurationModel } from '@jbrowse/core/configuration/configurationSchema'\nimport { contrastingTextColor } from '@jbrowse/core/util/color'\nimport { Feature } from '@jbrowse/core/util/simpleFeature'\nimport { Region } from '@jbrowse/core/util/types'\nimport { createJBrowseTheme } from '@jbrowse/core/ui'\nimport { observer } from 'mobx-react'\nimport React from 'react'\nimport {\n  bpSpanPx,\n  revcom,\n  complement,\n  defaultStarts,\n  defaultStops,\n  defaultCodonTable,\n  generateCodonTable,\n} from '@jbrowse/core/util'\n\ninterface MyProps {\n  exportSVG?: { rasterizeLayers: boolean }\n  features: Map<string, Feature>\n  regions: Region[]\n  bpPerPx: number\n  config: AnyConfigurationModel\n  highResolutionScaling: number\n  theme: any\n  showForward: boolean\n  showReverse: boolean\n  showTranslation: boolean\n}\n\nfunction Translation(props: {\n  codonTable: any\n  seq: string\n  frame: number\n  bpPerPx: number\n  region: Region\n  reverse?: boolean\n  height: number\n  y: number\n  theme?: any\n}) {\n  const {\n    codonTable,\n    seq,\n    frame,\n    bpPerPx,\n    region,\n    height,\n    y,\n    reverse = false,\n    theme,\n  } = props\n  const scale = bpPerPx\n\n  // the tilt variable normalizes the frame to where we are starting from,\n  // which increases consistency across blocks\n  const tilt = 3 - (region.start % 3)\n\n  // the effectiveFrame incorporates tilt and the frame to say what the\n  // effective frame that is plotted. The +3 is for when frame is -2 and this\n  // can otherwise result in effectiveFrame -1\n  const effectiveFrame = (frame + tilt + 3) % 3\n\n  const seqSliced = seq.slice(effectiveFrame)\n\n  const translated: { letter: string; codon: string }[] = []\n  for (let i = 0; i < seqSliced.length; i += 3) {\n    const codon = seqSliced.slice(i, i + 3)\n    const normalizedCodon = reverse ? revcom(codon) : codon\n    const aminoAcid = codonTable[normalizedCodon] || ''\n    translated.push({ letter: aminoAcid, codon: normalizedCodon.toUpperCase() })\n  }\n\n  const w = (1 / scale) * 3\n  const drop = region.start === 0 ? 0 : w\n  const render = 1 / bpPerPx >= 12\n  const width = (region.end - region.start) / bpPerPx\n\n  const map = ['#d8d8d8', '#adadad', '#8f8f8f'].reverse()\n  return (\n    <>\n      {translated.map((element, index) => {\n        const x = region.reversed\n          ? width - (w * (index + 1) + effectiveFrame / scale - drop)\n          : w * index + effectiveFrame / scale - drop\n        const { letter, codon } = element\n        return (\n          <React.Fragment key={`${index}-${letter}`}>\n            <rect\n              x={x}\n              y={y}\n              width={\n                render ? w : w + 0.7 /* small fudge factor when zoomed out*/\n              }\n              height={height}\n              stroke={render ? '#555' : 'none'}\n              fill={\n                defaultStarts.includes(codon)\n                  ? theme.palette.startCodon\n                  : defaultStops.includes(codon)\n                  ? theme.palette.stopCodon\n                  : map[Math.abs(frame)]\n              }\n            />\n            {render ? (\n              <text\n                x={x + w / 2}\n                y={y + height / 2}\n                dominantBaseline=\"middle\"\n                textAnchor=\"middle\"\n              >\n                {letter}\n              </text>\n            ) : null}\n          </React.Fragment>\n        )\n      })}\n    </>\n  )\n}\n\nfunction DNA(props: {\n  seq: string\n  theme: any\n  bpPerPx: number\n  height: number\n  region: Region\n  feature: Feature\n  y: number\n}) {\n  const { bpPerPx, region, feature, theme, height, seq, y } = props\n  const render = 1 / bpPerPx >= 12\n\n  const [leftPx, rightPx] = bpSpanPx(\n    feature.get('start'),\n    feature.get('end'),\n    region,\n    bpPerPx,\n  )\n  const reverse = region.reversed\n  const len = feature.get('end') - feature.get('start')\n  const w = Math.max((rightPx - leftPx) / len, 0.8)\n\n  return (\n    <>\n      {seq.split('').map((letter, index) => {\n        const color = theme.palette.bases[letter.toUpperCase()]\n        const x = reverse ? rightPx - (index + 1) * w : leftPx + index * w\n        return (\n          <React.Fragment key={index}>\n            <rect\n              x={x}\n              y={y}\n              width={w}\n              height={height}\n              fill={color ? color.main : '#aaa'}\n              stroke={render ? '#555' : 'none'}\n            />\n            {render ? (\n              <text\n                x={x + w / 2}\n                y={y + height / 2}\n                dominantBaseline=\"middle\"\n                textAnchor=\"middle\"\n                fill={color ? contrastingTextColor(color.main) : 'black'}\n              >\n                {letter}\n              </text>\n            ) : null}\n          </React.Fragment>\n        )\n      })}\n    </>\n  )\n}\n\nconst SequenceSVG = ({\n  regions,\n  theme: configTheme,\n  features = new Map(),\n  showReverse,\n  showForward,\n  showTranslation,\n  bpPerPx,\n}: any) => {\n  const [region] = regions\n  const theme = createJBrowseTheme(configTheme)\n  const codonTable = generateCodonTable(defaultCodonTable)\n  const height = 20\n  const [feature] = [...features.values()]\n  if (!feature) {\n    return null\n  }\n  const seq: string = feature.get('seq')\n  if (!seq) {\n    return null\n  }\n\n  // incrementer for the y-position of the current sequence being rendered\n  // (applies to both translation rows and dna rows)\n  let currY = -20\n\n  return (\n    <>\n      {/* the upper translation row. if the view is reversed, the reverse\n        translation is on the top */}\n      {showTranslation && (region.reversed ? showReverse : showForward)\n        ? [2, 1, 0].map(index => (\n            <Translation\n              key={`translation-${index}`}\n              seq={seq}\n              y={(currY += 20)}\n              codonTable={codonTable}\n              frame={index}\n              bpPerPx={bpPerPx}\n              region={region}\n              theme={theme}\n              height={height}\n              reverse={region.reversed}\n            />\n          ))\n        : null}\n\n      {showForward ? (\n        <DNA\n          height={height}\n          y={(currY += 20)}\n          feature={feature}\n          region={region}\n          seq={region.reversed ? complement(seq) : seq}\n          bpPerPx={bpPerPx}\n          theme={theme}\n        />\n      ) : null}\n\n      {showReverse ? (\n        <DNA\n          height={height}\n          y={(currY += 20)}\n          feature={feature}\n          region={region}\n          seq={region.reversed ? seq : complement(seq)}\n          bpPerPx={bpPerPx}\n          theme={theme}\n        />\n      ) : null}\n\n      {/* the lower translation row. if the view is reversed, the forward\n        translation is on the bottom */}\n      {showTranslation && (region.reversed ? showForward : showReverse)\n        ? [0, -1, -2].map(index => (\n            <Translation\n              key={`rev-translation-${index}`}\n              seq={seq}\n              y={(currY += 20)}\n              codonTable={codonTable}\n              frame={index}\n              bpPerPx={bpPerPx}\n              region={region}\n              theme={theme}\n              height={height}\n              reverse={!region.reversed}\n            />\n          ))\n        : null}\n    </>\n  )\n}\n\nconst Wrapper = ({ exportSVG, width, totalHeight, children }: any) => {\n  return exportSVG ? (\n    <>{children}</>\n  ) : (\n    <svg\n      width={width}\n      height={totalHeight}\n      style={{ width, height: totalHeight }}\n    >\n      {children}\n    </svg>\n  )\n}\n\nfunction Sequence(props: MyProps) {\n  const { regions, bpPerPx } = props\n  const [region] = regions\n  const width = (region.end - region.start) / bpPerPx\n  const totalHeight = 200\n\n  return (\n    <Wrapper {...props} totalHeight={totalHeight} width={width}>\n      <SequenceSVG {...props} />\n    </Wrapper>\n  )\n}\n\nexport default observer(Sequence)\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default ConfigurationSchema(\n  'DivSequenceRenderer',\n  {\n    height: {\n      type: 'number',\n      description: 'height in pixels of each line of sequence',\n      defaultValue: 16,\n    },\n  },\n  { explicitlyTyped: true },\n)\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default ConfigurationSchema(\n  'IndexedFastaAdapter',\n  {\n    fastaLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/seq.fa' },\n    },\n    faiLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/seq.fa.fai' },\n    },\n  },\n  { explicitlyTyped: true },\n)\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { configSchema as divSequenceRendererConfigSchema } from '../DivSequenceRenderer'\n\nexport const configSchema = ConfigurationSchema(\n  'LinearReferenceSequenceDisplay',\n  { renderer: divSequenceRendererConfigSchema },\n  { explicitIdentifier: 'displayId', explicitlyTyped: true },\n)\n","import { types } from 'mobx-state-tree'\nimport {\n  BaseLinearDisplay,\n  LinearGenomeViewModel,\n} from '@jbrowse/plugin-linear-genome-view'\nimport { ConfigurationReference } from '@jbrowse/core/configuration'\nimport { getParentRenderProps } from '@jbrowse/core/util/tracks'\nimport { AnyConfigurationSchemaType } from '@jbrowse/core/configuration/configurationSchema'\nimport { getContainingView } from '@jbrowse/core/util'\n\nexport function modelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearReferenceSequenceDisplay',\n      BaseLinearDisplay,\n      types.model({\n        type: types.literal('LinearReferenceSequenceDisplay'),\n        configuration: ConfigurationReference(configSchema),\n        showForward: types.optional(types.boolean, true),\n        showReverse: types.optional(types.boolean, true),\n        showTranslation: types.optional(types.boolean, true),\n        height: 180,\n      }),\n    )\n    .views(self => ({\n      get renderProps() {\n        const { showForward, showReverse, showTranslation } = self\n        return {\n          ...self.composedRenderProps,\n          ...getParentRenderProps(self),\n          rpcDriverName: self.rpcDriverName,\n          config: self.configuration.renderer,\n          showForward,\n          showReverse,\n          showTranslation,\n        }\n      },\n      regionCannotBeRendered(/* region */) {\n        const view = getContainingView(self) as LinearGenomeViewModel\n        if (view && view.bpPerPx >= 1) {\n          return 'Zoom in to see sequence'\n        }\n        return undefined\n      },\n\n      get rendererTypeName() {\n        return self.configuration.renderer.type\n      },\n    }))\n    .actions(self => ({\n      toggleShowForward() {\n        self.showForward = !self.showForward\n      },\n      toggleShowReverse() {\n        self.showReverse = !self.showReverse\n      },\n      toggleShowTranslation() {\n        self.showTranslation = !self.showTranslation\n      },\n    }))\n    .views(self => ({\n      get trackMenuItems() {\n        return [\n          {\n            label: 'Show forward',\n            type: 'checkbox',\n            checked: self.showForward,\n            onClick: () => {\n              self.toggleShowForward()\n            },\n          },\n          {\n            label: 'Show reverse',\n            type: 'checkbox',\n            checked: self.showReverse,\n            onClick: () => {\n              self.toggleShowReverse()\n            },\n          },\n          {\n            label: 'Show translation',\n            type: 'checkbox',\n            checked: self.showTranslation,\n            onClick: () => {\n              self.toggleShowTranslation()\n            },\n          },\n        ]\n      },\n    }))\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default ConfigurationSchema(\n  'TwoBitAdapter',\n  {\n    twoBitLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/my.2bit' },\n    },\n  },\n  { explicitlyTyped: true },\n)\n","import PluginManager from '@jbrowse/core/PluginManager'\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default (pluginManager: PluginManager) => {\n  return ConfigurationSchema(\n    'GCContentAdapter',\n    {\n      sequenceAdapter: pluginManager.pluggableConfigSchemaType('adapter'),\n    },\n    { explicitlyTyped: true },\n  )\n}\n","import PluginManager from '@jbrowse/core/PluginManager'\nimport configSchemaF from './configSchema'\n\nexport default (pluginManager: PluginManager) => {\n  return {\n    configSchema: pluginManager.load(configSchemaF),\n    getAdapterClass: () => import('./GCContentAdapter').then(r => r.default),\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { types } from 'mobx-state-tree'\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport PluginManager from '@jbrowse/core/PluginManager'\n\n/*\nNote: this is primarily a copy of createBaseTrackConfig, except with a subset\nof the config slots, to avoid including fields that don't make sense for the\nReferenceSequenceTrack\n*/\nexport function createReferenceSeqTrackConfig(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'ReferenceSequenceTrack',\n    {\n      adapter: pluginManager.pluggableConfigSchemaType('adapter'),\n      displays: types.array(pluginManager.pluggableConfigSchemaType('display')),\n      metadata: {\n        type: 'frozen',\n        description: 'anything to add about this track',\n        defaultValue: {},\n      },\n    },\n    {\n      preProcessSnapshot: s => {\n        const snap = JSON.parse(JSON.stringify(s))\n        const displayTypes = new Set()\n        const { displays = [] } = snap\n        if (snap.trackId !== 'placeholderId') {\n          // Gets the displays on the track snapshot and the possible displays\n          // from the track type and adds any missing possible displays to the\n          // snapshot\n          displays.forEach((d: any) => d && displayTypes.add(d.type))\n          const trackType = pluginManager.getTrackType(snap.type)\n          trackType.displayTypes.forEach(displayType => {\n            if (!displayTypes.has(displayType.name)) {\n              displays.push({\n                displayId: `${snap.trackId}-${displayType.name}`,\n                type: displayType.name,\n              })\n            }\n          })\n        }\n        return { ...snap, displays }\n      },\n      explicitIdentifier: 'trackId',\n      explicitlyTyped: true,\n      actions: (self: any) => ({\n        addDisplayConf(displayConf: { type: string; displayId: string }) {\n          const { type } = displayConf\n          if (!type) {\n            throw new Error(`unknown display type ${type}`)\n          }\n          const display = self.displays.find(\n            (d: any) => d && d.displayId === displayConf.displayId,\n          )\n          if (display) {\n            return display\n          }\n          const length = self.displays.push(displayConf)\n          return self.displays[length - 1]\n        },\n      }),\n    },\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\nimport { Region } from '@jbrowse/core/util/types'\nimport { createBaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\nimport FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\nimport TrackType from '@jbrowse/core/pluggableElementTypes/TrackType'\nimport Plugin from '@jbrowse/core/Plugin'\nimport PluginManager from '@jbrowse/core/PluginManager'\nimport { BaseLinearDisplayComponent } from '@jbrowse/plugin-linear-genome-view'\nimport { configSchema as bgzipFastaAdapterConfigSchema } from './BgzipFastaAdapter'\nimport { configSchema as chromSizesAdapterConfigSchema } from './ChromSizesAdapter'\nimport {\n  configSchema as divSequenceRendererConfigSchema,\n  ReactComponent as DivSequenceRendererReactComponent,\n} from './DivSequenceRenderer'\nimport { configSchema as indexedFastaAdapterConfigSchema } from './IndexedFastaAdapter'\nimport {\n  configSchema as linearReferenceSequenceDisplayConfigSchema,\n  modelFactory as linearReferenceSequenceDisplayModelFactory,\n} from './LinearReferenceSequenceDisplay'\nimport { configSchema as twoBitAdapterConfigSchema } from './TwoBitAdapter'\nimport GCContentAdapterF from './GCContentAdapter'\nimport { createReferenceSeqTrackConfig } from './referenceSeqTrackConfig'\n\n/* adjust in both directions */\nclass DivSequenceRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  getExpandedRegion(region: Region) {\n    return {\n      ...region,\n      start: Math.max(region.start - 3, 0),\n      end: region.end + 3,\n    }\n  }\n}\n\nexport default class SequencePlugin extends Plugin {\n  name = 'SequencePlugin'\n\n  install(pluginManager: PluginManager) {\n    pluginManager.addAdapterType(\n      () =>\n        new AdapterType({\n          name: 'TwoBitAdapter',\n          configSchema: twoBitAdapterConfigSchema,\n          getAdapterClass: () =>\n            import('./TwoBitAdapter/TwoBitAdapter').then(r => r.default),\n        }),\n    )\n\n    pluginManager.addAdapterType(\n      () =>\n        new AdapterType({\n          name: 'ChromSizesAdapter',\n          configSchema: chromSizesAdapterConfigSchema,\n          getAdapterClass: () =>\n            import('./ChromSizesAdapter/ChromSizesAdapter').then(\n              r => r.default,\n            ),\n        }),\n    )\n\n    pluginManager.addAdapterType(\n      () =>\n        new AdapterType({\n          name: 'IndexedFastaAdapter',\n          configSchema: indexedFastaAdapterConfigSchema,\n          getAdapterClass: () =>\n            import('./IndexedFastaAdapter/IndexedFastaAdapter').then(\n              r => r.default,\n            ),\n        }),\n    )\n\n    pluginManager.addAdapterType(\n      () =>\n        new AdapterType({\n          name: 'BgzipFastaAdapter',\n          configSchema: bgzipFastaAdapterConfigSchema,\n          getAdapterClass: () =>\n            import('./BgzipFastaAdapter/BgzipFastaAdapter').then(\n              r => r.default,\n            ),\n        }),\n    )\n\n    pluginManager.addAdapterType(\n      () =>\n        new AdapterType({\n          name: 'GCContentAdapter',\n          ...pluginManager.load(GCContentAdapterF),\n        }),\n    )\n    pluginManager.addTrackType(() => {\n      const configSchema = createReferenceSeqTrackConfig(pluginManager)\n\n      return new TrackType({\n        name: 'ReferenceSequenceTrack',\n        configSchema,\n        stateModel: createBaseTrackModel(\n          pluginManager,\n          'ReferenceSequenceTrack',\n          configSchema,\n        ),\n      })\n    })\n\n    pluginManager.addDisplayType(() => {\n      const stateModel = linearReferenceSequenceDisplayModelFactory(\n        linearReferenceSequenceDisplayConfigSchema,\n      )\n      return {\n        name: 'LinearReferenceSequenceDisplay',\n        configSchema: linearReferenceSequenceDisplayConfigSchema,\n        stateModel,\n        trackType: 'ReferenceSequenceTrack',\n        viewType: 'LinearGenomeView',\n        ReactComponent: BaseLinearDisplayComponent,\n      }\n    })\n\n    pluginManager.addRendererType(\n      () =>\n        new DivSequenceRenderer({\n          name: 'DivSequenceRenderer',\n          ReactComponent: DivSequenceRendererReactComponent,\n          configSchema: divSequenceRendererConfigSchema,\n          pluginManager,\n        }),\n    )\n  }\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","import {\n  BaseFeatureDataAdapter,\n  BaseOptions,\n} from '@jbrowse/core/data_adapters/BaseAdapter'\nimport { Region } from '@jbrowse/core/util/types'\nimport { ObservableCreate } from '@jbrowse/core/util/rxjs'\nimport SimpleFeature, { Feature } from '@jbrowse/core/util/simpleFeature'\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport { toArray } from 'rxjs/operators'\n\nexport default class extends BaseFeatureDataAdapter {\n  private windowSize = 1000\n\n  private windowDelta = 1000\n\n  private gcMode = 'content'\n\n  public static capabilities = ['hasLocalStats']\n\n  public async configure() {\n    // instantiate the sequence adapter\n    const sequenceAdapter = readConfObject(this.config, 'sequenceAdapter')\n\n    const dataAdapter = await this.getSubAdapter?.(sequenceAdapter)\n    if (!dataAdapter) {\n      throw new Error('Error getting subadapter')\n    }\n    return dataAdapter.dataAdapter as BaseFeatureDataAdapter\n  }\n\n  public async getRefNames() {\n    const sequenceAdapter = await this.configure()\n    return sequenceAdapter.getRefNames()\n  }\n\n  /**\n   * Fetch features for a certain region\n   * @param param -\n   * @returns Observable of Feature objects in the region\n   */\n  public getFeatures(query: Region, opts: BaseOptions) {\n    this.windowSize = 1000\n    this.windowDelta = 1000\n    this.gcMode = 'content'\n    return ObservableCreate<Feature>(async observer => {\n      const sequenceAdapter = await this.configure()\n      const hw = this.windowSize === 1 ? 1 : this.windowSize / 2 // Half the window size\n      const f = this.windowSize === 1\n\n      let { start: queryStart, end: queryEnd } = query\n      queryStart = Math.max(0, queryStart - hw)\n      queryEnd += hw\n\n      if (queryEnd < 0 || queryStart > queryEnd) {\n        observer.complete()\n        return\n      }\n\n      const ret = sequenceAdapter.getFeatures(\n        { ...query, start: queryStart, end: queryEnd },\n        opts,\n      )\n      const [feat] = await ret.pipe(toArray()).toPromise()\n      const residues = feat.get('seq')\n\n      for (let i = hw; i < residues.length - hw; i += this.windowDelta) {\n        const r = f ? residues[i] : residues.slice(i - hw, i + hw)\n        let nc = 0\n        let ng = 0\n        let len = 0\n        for (let j = 0; j < r.length; j++) {\n          if (r[j] === 'c' || r[j] === 'C') {\n            nc++\n          } else if (r[j] === 'g' || r[j] === 'G') {\n            ng++\n          }\n          if (r[j] !== 'N') {\n            len++\n          }\n        }\n        const pos = queryStart\n        let score\n        if (this.gcMode === 'content') {\n          score = (ng + nc) / (len || 1)\n        } else if (this.gcMode === 'skew') {\n          score = (ng - nc) / (ng + nc || 1)\n        }\n\n        // if (r[Math.floor(r.length / 2)] !== 'N') {\n        observer.next(\n          new SimpleFeature({\n            uniqueId: `${this.id}_${pos + i}`,\n            start: pos + i,\n            end: pos + i + this.windowDelta,\n            score,\n          }),\n        )\n        // }\n      }\n      observer.complete()\n    })\n  }\n\n  /**\n   * called to provide a hint that data tied to a certain region\n   * will not be needed for the forseeable future and can be purged\n   * from caches, etc\n   */\n  public freeResources(/* { region } */): void {}\n}\n","import {\n  BaseFeatureDataAdapter,\n  SequenceAdapter,\n} from '@jbrowse/core/data_adapters/BaseAdapter'\nimport { NoAssemblyRegion } from '@jbrowse/core/util/types'\nimport { openLocation } from '@jbrowse/core/util/io'\nimport { ObservableCreate } from '@jbrowse/core/util/rxjs'\nimport SimpleFeature, { Feature } from '@jbrowse/core/util/simpleFeature'\nimport { TwoBitFile } from '@gmod/twobit'\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport { Instance } from 'mobx-state-tree'\n\nimport configSchema from './configSchema'\n\nexport default class TwoBitAdapter\n  extends BaseFeatureDataAdapter\n  implements SequenceAdapter {\n  private twobit: typeof TwoBitFile\n\n  constructor(config: Instance<typeof configSchema>) {\n    super(config)\n    const twoBitOpts = {\n      filehandle: openLocation(readConfObject(config, 'twoBitLocation')),\n    }\n\n    this.twobit = new TwoBitFile(twoBitOpts)\n  }\n\n  public getRefNames() {\n    return this.twobit.getSequenceNames()\n  }\n\n  public async getRegions(): Promise<NoAssemblyRegion[]> {\n    const refSizes = await this.twobit.getSequenceSizes()\n    return Object.keys(refSizes).map(\n      (refName: string): NoAssemblyRegion => ({\n        refName,\n        start: 0,\n        end: refSizes[refName],\n      }),\n    )\n  }\n\n  /**\n   * Fetch features for a certain region\n   * @param param -\n   * @returns Observable of Feature objects in the region\n   */\n  public getFeatures({ refName, start, end }: NoAssemblyRegion) {\n    return ObservableCreate<Feature>(async observer => {\n      const size = await this.twobit.getSequenceSize(refName)\n      const regionEnd = size !== undefined ? Math.min(size, end) : end\n      const seq: string = await this.twobit.getSequence(\n        refName,\n        start,\n        regionEnd,\n      )\n      if (seq) {\n        observer.next(\n          new SimpleFeature({\n            id: `${refName} ${start}-${regionEnd}`,\n            data: { refName, start, end: regionEnd, seq },\n          }),\n        )\n      }\n      observer.complete()\n    })\n  }\n\n  /**\n   * called to provide a hint that data tied to a certain region\n   * will not be needed for the forseeable future and can be purged\n   * from caches, etc\n   */\n  public freeResources(/* { region } */): void {}\n}\n","import {\n  RegionsAdapter,\n  BaseAdapter,\n} from '@jbrowse/core/data_adapters/BaseAdapter'\nimport { FileLocation } from '@jbrowse/core/util/types'\nimport { openLocation } from '@jbrowse/core/util/io'\nimport { GenericFilehandle } from 'generic-filehandle'\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport { Instance } from 'mobx-state-tree'\nimport MyConfigSchema from './configSchema'\n\nexport default class extends BaseAdapter implements RegionsAdapter {\n  // the map of refSeq to length\n  protected refSeqs: Promise<Record<string, number>>\n\n  protected source: string\n\n  public constructor(config: Instance<typeof MyConfigSchema>) {\n    super(config)\n    const chromSizesLocation = readConfObject(config, 'chromSizesLocation')\n    if (!chromSizesLocation) {\n      throw new Error('must provide chromSizesLocation')\n    }\n    const file = openLocation(chromSizesLocation as FileLocation)\n    this.source = file.toString()\n    this.refSeqs = this.init(file)\n  }\n\n  private async init(file: GenericFilehandle) {\n    const data = (await file.readFile('utf8')) as string\n    const refSeqs: { [key: string]: number } = {}\n    if (!data.length) {\n      throw new Error(`Could not read file ${file.toString()}`)\n    }\n    data.split('\\n').forEach((line: string) => {\n      if (line.length) {\n        const [name, length] = line.split('\\t')\n        refSeqs[name] = +length\n      }\n    })\n    return refSeqs\n  }\n\n  public async getRegions() {\n    const refSeqs = await this.refSeqs\n    return Object.keys(refSeqs).map(refName => ({\n      refName,\n      start: 0,\n      end: refSeqs[refName],\n    }))\n  }\n\n  public freeResources(/* { region } */): void {}\n}\n","import { IndexedFasta } from '@gmod/indexedfasta'\nimport {\n  BaseFeatureDataAdapter,\n  SequenceAdapter,\n} from '@jbrowse/core/data_adapters/BaseAdapter'\nimport { FileLocation, NoAssemblyRegion } from '@jbrowse/core/util/types'\nimport { openLocation } from '@jbrowse/core/util/io'\nimport { ObservableCreate } from '@jbrowse/core/util/rxjs'\nimport SimpleFeature, { Feature } from '@jbrowse/core/util/simpleFeature'\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport { AnyConfigurationModel } from '@jbrowse/core/configuration/configurationSchema'\nimport AbortablePromiseCache from 'abortable-promise-cache'\nimport LRU from '@jbrowse/core/util/QuickLRU'\n\nexport default class extends BaseFeatureDataAdapter implements SequenceAdapter {\n  protected fasta: typeof IndexedFasta\n\n  private seqCache = new AbortablePromiseCache({\n    cache: new LRU({ maxSize: 200 }),\n    fill: async (\n      args: { refName: string; start: number; end: number },\n      // abortSignal?: AbortSignal,\n    ) => {\n      const { refName, start, end } = args\n      return this.fasta.getSequence(refName, start, end)\n    },\n  })\n\n  public constructor(config: AnyConfigurationModel) {\n    super(config)\n    const fastaLocation = readConfObject(config, 'fastaLocation')\n    const faiLocation = readConfObject(config, 'faiLocation')\n    if (!fastaLocation) {\n      throw new Error('must provide fastaLocation')\n    }\n    if (!faiLocation) {\n      throw new Error('must provide faiLocation')\n    }\n    const fastaOpts = {\n      fasta: openLocation(fastaLocation as FileLocation),\n      fai: openLocation(faiLocation as FileLocation),\n    }\n\n    this.fasta = new IndexedFasta(fastaOpts)\n  }\n\n  public getRefNames() {\n    return this.fasta.getSequenceNames()\n  }\n\n  public async getRegions(): Promise<NoAssemblyRegion[]> {\n    const seqSizes = await this.fasta.getSequenceSizes()\n    return Object.keys(seqSizes).map(\n      (refName: string): NoAssemblyRegion => ({\n        refName,\n        start: 0,\n        end: seqSizes[refName],\n      }),\n    )\n  }\n\n  /**\n   * Fetch features for a certain region\n   * @param param -\n   * @returns Observable of Feature objects in the region\n   */\n  public getFeatures({ refName, start, end }: NoAssemblyRegion) {\n    return ObservableCreate<Feature>(async observer => {\n      const size = await this.fasta.getSequenceSize(refName)\n      const regionEnd = size !== undefined ? Math.min(size, end) : end\n      const chunks = []\n      const chunkSize = 128000\n\n      const s = start - (start % chunkSize)\n      const e = end + (chunkSize - (end % chunkSize))\n      for (let chunkStart = s; chunkStart < e; chunkStart += chunkSize) {\n        const r = {\n          refName,\n          start: chunkStart,\n          end: chunkStart + chunkSize,\n        }\n        chunks.push(this.seqCache.get(JSON.stringify(r), r))\n      }\n      const seq = (await Promise.all(chunks))\n        .join('')\n        .slice(start - s)\n        .slice(0, end - start)\n      if (seq) {\n        observer.next(\n          new SimpleFeature({\n            id: `${refName} ${start}-${regionEnd}`,\n            data: { refName, start, end: regionEnd, seq },\n          }),\n        )\n      }\n      observer.complete()\n    })\n  }\n\n  /**\n   * called to provide a hint that data tied to a certain region\n   * will not be needed for the forseeable future and can be purged\n   * from caches, etc\n   */\n  public freeResources(/* { region } */): void {}\n}\n","import { BgzipIndexedFasta } from '@gmod/indexedfasta'\nimport { FileLocation } from '@jbrowse/core/util/types'\nimport { openLocation } from '@jbrowse/core/util/io'\nimport { Instance } from 'mobx-state-tree'\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport IndexedFasta from '../IndexedFastaAdapter/IndexedFastaAdapter'\nimport MyConfigSchema from './configSchema'\n\nexport default class extends IndexedFasta {\n  public constructor(config: Instance<typeof MyConfigSchema>) {\n    super(config)\n    const fastaLocation = readConfObject(config, 'fastaLocation')\n    const faiLocation = readConfObject(config, 'faiLocation')\n    const gziLocation = readConfObject(config, 'gziLocation')\n    if (!fastaLocation) {\n      throw new Error('must provide fastaLocation')\n    }\n    if (!faiLocation) {\n      throw new Error('must provide faiLocation')\n    }\n    if (!gziLocation) {\n      throw new Error('must provide gziLocation')\n    }\n    const fastaOpts = {\n      fasta: openLocation(fastaLocation as FileLocation),\n      fai: openLocation(faiLocation as FileLocation),\n      gzi: openLocation(gziLocation as FileLocation),\n    }\n\n    this.fasta = new BgzipIndexedFasta(fastaOpts)\n  }\n}\n"],"names":["ConfigurationSchema","fastaLocation","type","defaultValue","uri","faiLocation","gziLocation","explicitlyTyped","chromSizesLocation","Translation","props","codonTable","seq","frame","bpPerPx","region","height","y","reverse","theme","scale","tilt","start","effectiveFrame","seqSliced","slice","translated","i","length","codon","normalizedCodon","revcom","aminoAcid","push","letter","toUpperCase","w","drop","render","width","end","map","React","element","index","x","reversed","Fragment","key","stroke","fill","defaultStarts","includes","palette","startCodon","defaultStops","stopCodon","Math","abs","dominantBaseline","textAnchor","DNA","feature","bpSpanPx","get","leftPx","rightPx","len","max","split","color","bases","main","contrastingTextColor","SequenceSVG","regions","configTheme","features","Map","showReverse","showForward","showTranslation","createJBrowseTheme","generateCodonTable","defaultCodonTable","values","currY","complement","Wrapper","exportSVG","totalHeight","children","style","Sequence","observer","description","configSchema","renderer","divSequenceRendererConfigSchema","explicitIdentifier","modelFactory","types","compose","BaseLinearDisplay","model","literal","configuration","ConfigurationReference","optional","views","self","renderProps","composedRenderProps","getParentRenderProps","rpcDriverName","config","regionCannotBeRendered","view","getContainingView","undefined","rendererTypeName","actions","toggleShowForward","toggleShowReverse","toggleShowTranslation","trackMenuItems","label","checked","onClick","twoBitLocation","pluginManager","sequenceAdapter","pluggableConfigSchemaType","load","configSchemaF","getAdapterClass","then","r","createReferenceSeqTrackConfig","adapter","displays","array","metadata","preProcessSnapshot","s","snap","JSON","parse","stringify","displayTypes","Set","trackId","forEach","d","add","trackType","getTrackType","displayType","has","name","displayId","addDisplayConf","displayConf","Error","display","find","DivSequenceRenderer","FeatureRendererType","SequencePlugin","addAdapterType","AdapterType","twoBitAdapterConfigSchema","chromSizesAdapterConfigSchema","indexedFastaAdapterConfigSchema","bgzipFastaAdapterConfigSchema","GCContentAdapterF","addTrackType","TrackType","stateModel","createBaseTrackModel","addDisplayType","linearReferenceSequenceDisplayModelFactory","linearReferenceSequenceDisplayConfigSchema","viewType","ReactComponent","BaseLinearDisplayComponent","addRendererType","DivSequenceRendererReactComponent","Plugin","runtime","exports","Op","Object","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","value","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","makeInvokeMethod","tryCatch","fn","arg","call","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","Gp","constructor","displayName","defineIteratorMethods","method","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","__await","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","unwrapped","error","previousPromise","enqueue","callInvokeWithMethodAndArg","async","Promise","iter","next","done","state","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","info","resultName","nextLoc","toString","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","keys","object","pop","iterable","iteratorMethod","isNaN","skipTempReset","prev","charAt","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","Function","readConfObject","getSubAdapter","dataAdapter","configure","getRefNames","query","opts","windowSize","windowDelta","gcMode","ObservableCreate","hw","f","queryStart","queryEnd","ret","getFeatures","pipe","toArray","toPromise","feat","residues","nc","ng","j","pos","score","SimpleFeature","uniqueId","id","BaseFeatureDataAdapter","default_1","TwoBitAdapter","twoBitOpts","filehandle","openLocation","twobit","TwoBitFile","getSequenceNames","getSequenceSizes","refSizes","refName","getSequenceSize","size","regionEnd","min","getSequence","data","file","source","refSeqs","init","readFile","line","BaseAdapter","AbortablePromiseCache","cache","LRU","maxSize","args","fasta","fastaOpts","fai","IndexedFasta","seqSizes","chunks","chunkSize","e","chunkStart","seqCache","all","join","gzi","BgzipIndexedFasta"],"mappings":"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"}