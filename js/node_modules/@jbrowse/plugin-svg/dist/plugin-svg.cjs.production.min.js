"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("@jbrowse/core/pluggableElementTypes/renderers/BoxRendererType")),r=e(require("@jbrowse/core/Plugin")),n=require("@jbrowse/core/configuration"),o=require("@jbrowse/core/util/types/mst"),a=require("@jbrowse/core/util"),i=e(require("@jbrowse/core/util/layouts/SceneGraph")),u=require("mobx-react"),s=e(require("prop-types")),l=require("react"),c=e(l),f=require("@jbrowse/core/util/color"),d=e(require("@jbrowse/core/util/simpleFeature")),p=require("mobx-state-tree");function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t.indexOf(r=a[n])>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t.indexOf(r=a[n])>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function m(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||M(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){if(e){if("string"==typeof e)return P(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?P(e,t):void 0}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function w(e){var t=e.text,r=e.x,n=e.y,o=e.color,i=void 0===o?"black":o,u=e.fontHeight,s=void 0===u?13:u,l=e.featureWidth,f=void 0===l?0:l,d=e.reversed,p=e.allowedWidthExpansion,g=e.fontWidthScaleFactor,b=s*(void 0===g?.6:g),h=f&&p?f+p:Infinity,y=a.measureText(t,s);return c.createElement("text",{x:d?r+f-y:r,y:n+s,style:{fontSize:s,fill:i,cursor:"default"}},y>h?"".concat(t.slice(0,h/b),"..."):t)}function q(e){var t=e.feature,r=e.rootLayout,o=e.selected,a=e.config,i=e.name,u=e.shouldShowName,s=e.description,l=e.shouldShowDescription,f=e.fontHeight,d=e.allowedWidthExpansion,p=e.reversed,g=r.getSubRecord(String(t.id())),h=[c.createElement(g.data.GlyphComponent,b({key:"glyph-".concat(t.id())},e,{feature:t,featureLayout:g,selected:o}))];return u&&h.push(c.createElement(w,{key:"glyph-name-".concat(t.id()),text:i,x:r.getSubRecord("nameLabel").absolute.left,y:r.getSubRecord("nameLabel").absolute.top,color:n.readConfObject(a,["labels","nameColor"],{feature:t}),fontHeight:f,reversed:p,featureWidth:g.width,allowedWidthExpansion:d})),l&&h.push(c.createElement(w,{key:"glyph-description-".concat(t.id()),text:s,x:r.getSubRecord("descriptionLabel").absolute.left,y:r.getSubRecord("descriptionLabel").absolute.top,color:n.readConfObject(a,["labels","descriptionColor"],{feature:t}),fontHeight:f,featureWidth:g.width,reversed:p,allowedWidthExpansion:d})),c.createElement("g",null,h)}q.propTypes={feature:s.shape({id:s.func.isRequired,get:s.func.isRequired}).isRequired,layout:s.shape({addRect:s.func.isRequired,getTotalHeight:s.func.isRequired}).isRequired,rootLayout:s.shape({addChild:s.func.isRequired,getSubRecord:s.func.isRequired}).isRequired,region:o.PropTypes.Region.isRequired,bpPerPx:s.number.isRequired,reversed:s.bool,selected:s.bool,config:o.PropTypes.ConfigSchema.isRequired,name:s.string,shouldShowName:s.bool,description:s.string,shouldShowDescription:s.bool,fontHeight:s.number,allowedWidthExpansion:s.number,movedDuringLastMouseDown:s.bool.isRequired},q.defaultProps={reversed:!1,selected:!1,name:"",shouldShowName:!1,description:"",shouldShowDescription:!1,fontHeight:void 0,allowedWidthExpansion:void 0};var C=u.observer(q);function O(e){var t=e.rect,r=e.region,n=e.bpPerPx,o=v(e,["rect","region","bpPerPx"]);if(!t)return null;var i=x(t,4),u=i[1],s=i[3],l=x(a.bpSpanPx(i[0],i[2],r,n),2),f=l[0],d=l[1],p=Math.round(u),g=(r.end-r.start)/n,b=Math.round(s-u),h=d-f;if(f+h<0)return null;var y=Math.max(f,0),m=Math.max(1,Math.min(h-(y-f),g));return c.createElement("rect",Object.assign({x:y-2,y:p-2,width:m+4,height:b+4},o))}function S(e){var t=e.displayModel,r=t.blockLayoutFeatures,n=t.selectedFeatureId,o=t.featureIdUnderMouse,a=t.contextMenuFeature,i=e.blockKey,u=e.region,s=e.bpPerPx,l=e.movedDuringLastMouseDown,f=v(e,["displayModel","blockKey","region","bpPerPx","movedDuringLastMouseDown"]),d=null==r?void 0:r.get(i);if(!d)return null;var p=o||(null==a?void 0:a.id());function g(e){var t=f.onFeatureMouseOut;if(t&&p)return t(e,p)}function b(e){var t=f.onFeatureMouseOver;if(t&&p)return t(e,p)}return c.createElement(c.Fragment,null,p?c.createElement(O,{rect:d.get(p),region:u,bpPerPx:s,fill:"#000",fillOpacity:"0.2",onMouseDown:function(e){var t=f.onFeatureMouseDown;if(t&&p)return t(e,p)},onMouseEnter:function(e){var t=f.onFeatureMouseEnter;if(t&&p)return t(e,p)},onMouseOut:g,onMouseOver:b,onMouseUp:function(e){var t=f.onFeatureMouseUp;if(t&&p)return t(e,p)},onMouseLeave:function(e){var t=f.onFeatureMouseLeave;if(t&&p)return t(e,p)},onMouseMove:function(e){var t=f.onFeatureMouseMove;if(t&&p)return t(e,p)},onClick:function(e){if(!l){var t=f.onFeatureClick;if(t&&p)return e.stopPropagation(),t(e,p)}},onContextMenu:function(e){var t=f.onFeatureContextMenu;if(t&&p)return t(e,p)},onFocus:b,onBlur:g,"data-testid":p}):null,n?c.createElement(O,{rect:d.get(n),region:u,bpPerPx:s,stroke:"#00b8ff",fill:"none"}):null)}var E=u.observer(S);function T(e){var t,r=e.feature,o=e.region,a=e.config,i=e.featureLayout,u=e.selected,s=(o.end-o.start)/e.bpPerPx,l=n.readConfObject(a,"color1",{feature:r});try{t=f.emphasize(l,.3)}catch(e){t=l}var d=n.readConfObject(a,"color2",{feature:r}),p=i.absolute,g=p.left,b=p.top,h=p.width,y=p.height;if(g+h<0)return null;var v=Math.max(g,0),m=Math.max(1,Math.min(h-(v-g),s));return c.createElement("rect",{"data-testid":"box-".concat(r.id()),x:v,y:b,width:m,height:y,fill:u?t:l,stroke:u?d:void 0})}T.propTypes={feature:s.shape({get:s.func.isRequired,id:s.func.isRequired}).isRequired,region:o.PropTypes.Region.isRequired,bpPerPx:s.number.isRequired,featureLayout:s.shape({absolute:s.shape({top:s.number.isRequired,left:s.number.isRequired,width:s.number.isRequired,height:s.number.isRequired})}).isRequired,selected:s.bool,config:o.PropTypes.ConfigSchema.isRequired},T.defaultProps={selected:!1};var j=u.observer(T);function k(e){var t=e.feature,r=e.region,o=e.config,a=e.featureLayout,i=e.selected,u=e.reversed,s=(r.end-r.start)/e.bpPerPx,l=Math.max(a.absolute.width,1),d=a.absolute.left,p=a.absolute,g=p.top,b=p.height;z(t)&&(g+=.175*b,b*=.65);var h,y=t.get("strand")*(u?-1:1),v=z(t)?n.readConfObject(o,"color3",{feature:t}):n.readConfObject(o,"color1",{feature:t});try{h=f.emphasize(v,.3)}catch(e){h=v}var m=n.readConfObject(o,"color2",{feature:t});if(d+l<0)return null;var R=Math.max(d,0),x=R-d,M=Math.max(1,Math.min(l-x,s));return c.createElement(c.Fragment,null,c.createElement("rect",{"data-testid":t.id(),stroke:i?m:void 0,fill:i?h:v,x:R,y:g,width:M,height:b}),y<0&&0===x?c.createElement("polygon",{stroke:i?m:void 0,fill:i?h:v,points:[[d,g],[d-b/2,g+b/2],[d,g+b]]}):null,y>0&&R+M<s?c.createElement("polygon",{stroke:i?m:void 0,fill:i?h:v,points:[[R+M,g],[R+M+b/2,g+b/2],[R+M,g+b]]}):null)}k.propTypes={feature:s.shape({id:s.func.isRequired,get:s.func.isRequired}).isRequired,region:o.PropTypes.Region.isRequired,bpPerPx:s.number.isRequired,featureLayout:s.shape({absolute:s.shape({top:s.number.isRequired,left:s.number.isRequired,width:s.number.isRequired,height:s.number.isRequired})}).isRequired,selected:s.bool,config:o.PropTypes.ConfigSchema.isRequired,reversed:s.bool},k.defaultProps={selected:!1,reversed:!1};var L=u.observer(k);function F(e){var t,r=e.feature,o=e.featureLayout,a=e.selected,i=e.config,u=e.reversed,s=e.subfeatures||r.get("subfeatures"),l=n.readConfObject(i,"color2",{feature:r});try{t=f.emphasize(l,.3)}catch(e){t=l}var d=o.absolute,p=d.left,g=d.top,h=d.width,y=d.height,v=[[p,g+y/2],[p+h,g+y/2]],m=r.get("strand");return m&&v.push([p+h-y/4,g+y/4],[p+h-y/4,g+y/4*3],[p+h,g+y/2]),c.createElement(c.Fragment,null,c.createElement("polyline",{"data-testid":r.id(),transform:m&&(!u&&m<0||u&&m>0)?"rotate(180,".concat(p+h/2,",").concat(g+y/2,")"):void 0,points:v,stroke:a?t:l}),s.map((function(t){var r=String(t.id()),n=o.getSubRecord(r);return n?c.createElement(n.data.GlyphComponent,b({key:"glyph-".concat(r)},e,{feature:t,featureLayout:n,selected:a})):null})))}F.propTypes={feature:s.shape({id:s.func.isRequired,get:s.func.isRequired}).isRequired,featureLayout:s.shape({absolute:s.shape({top:s.number.isRequired,left:s.number.isRequired,width:s.number.isRequired,height:s.number.isRequired}),getSubRecord:s.func.isRequired}).isRequired,selected:s.bool,config:o.PropTypes.ConfigSchema.isRequired,reversed:s.bool},F.defaultProps={selected:!1,reversed:!1};var _=u.observer(F);function V(e){var t=D(e.feature,e.config);return c.createElement(_,b({},e,{subfeatures:t}))}function U(e){return/(\bUTR|_UTR|untranslated[_\s]region)\b/.test(e.get("type")||"")}function D(e,t){var r=e.get("subfeatures");if(!r||!r.length)return[];var o=!!r.find((function(e){return U(e)})),a=["mRNA","transcript"].includes(e.get("type"));return(!o&&a||n.readConfObject(t,"impliedUTRs"))&&(r=function(e,t){for(var r,n,o=function(e){if(Array.isArray(e))return P(e)}(c=t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(c)||M(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=Infinity,i=-Infinity,u=[],s=0;s<o.length;s++){var l=o[s].get("type");/^cds/i.test(l)?(a>o[s].get("start")&&(a=o[s].get("start")),i<o[s].get("end")&&(i=o[s].get("end"))):/exon/i.test(l)?u.push(o[s]):U(o[s])&&(r=o[s].get("start")===e.get("start"),n=o[s].get("end")===e.get("end"))}var c;if(!(u.length&&a<Infinity&&i>-Infinity))return o;u.sort((function(e,t){return e.get("start")-t.get("start")}));var f,p,g=e.get("strand");if(!r)for(var b=0;b<u.length&&!((f=u[b].get("start"))>=a);b++){p=a>u[b].get("end")?u[b].get("end"):a;var h=g>=0?"five_prime_UTR":"three_prime_UTR";o.unshift(new d({parent:e,id:"".concat(e.id(),"_").concat(h,"_").concat(b),data:{start:f,end:p,strand:g,type:h}}))}if(!n)for(var y=u.length-1;y>=0&&!((p=u[y].get("end"))<=i);y--){f=i<u[y].get("start")?u[y].get("start"):i;var v=g>=0?"three_prime_UTR":"five_prime_UTR";o.push(new d({parent:e,id:"".concat(e.id(),"_").concat(v,"_").concat(y),data:{start:f,end:p,strand:g,type:v}}))}return o}(e,r)),r.filter((function(e){return function(e,t){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"subParts",t=arguments.length>1?arguments[1]:void 0,r=n.readConfObject(t,e);if("string"==typeof r&&(r=r.split(/\s*,\s*/)),Array.isArray(r)){var o=r.map((function(e){return e.toLowerCase()}));return function(e){return o.includes(e.get("type").toLowerCase())}}return"function"==typeof r?r:function(){return!0}}("subParts",t)(e)}(e,t)}))}V.layOut=function(e){var t=e.feature,r=e.bpPerPx,n=e.reversed,o=e.config,a=B({layout:e.layout,feature:t,bpPerPx:r,reversed:n,config:o});return N({layout:a,subfeatures:D(t,o),bpPerPx:r,reversed:n,config:o}),a};var I=u.observer(V);function A(e){var t=e.featureLayout,r=e.selected;return c.createElement(c.Fragment,null,e.feature.get("subfeatures").map((function(n){var o=String(n.id()),a=t.getSubRecord(o);return c.createElement(a.data.GlyphComponent,b({key:"glyph-".concat(o)},e,{feature:n,featureLayout:a,selected:r}))})))}A.propTypes={feature:s.shape({get:s.func.isRequired}).isRequired,featureLayout:s.shape({getSubRecord:s.func.isRequired}).isRequired,selected:s.bool,reversed:s.bool},A.defaultProps={selected:!1,reversed:!1},A.layOut=function(e){var t=e.feature,r=e.bpPerPx,o=e.reversed,a=e.config,i=B({layout:e.layout,feature:t,bpPerPx:r,reversed:o,config:a}),u=n.readConfObject(a,"displayMode");if("reducedRepresentation"!==u){var s=t.get("subfeatures")||[],l=0;s.forEach((function(e){var t=G(e),s=n.readConfObject(a,"height",{feature:e});(t.layOut||W)({layout:i,feature:e,bpPerPx:r,reversed:o,config:a}).move(0,l),l+="collapse"===u?0:("compact"===u?s/3:s)+2}))}return i};var H=u.observer(A);function G(e){var t=e.get("type"),r=e.get("strand"),n=e.get("subfeatures");return n?n.find((function(e){return!!e.get("subfeatures")}))?H:["mRNA","transcript"].includes(t)&&n.find((function(e){return"CDS"===e.get("type")}))?I:_:[1,-1].includes(r)?L:j}function W(e){var t=e.layout,r=e.feature,o=e.bpPerPx,a=e.reversed,i=e.config,u=n.readConfObject(i,"displayMode"),s=B({layout:t,feature:r,bpPerPx:o,reversed:a,config:i});return"reducedRepresentation"!==u&&N({layout:s,subfeatures:r.get("subfeatures")||[],bpPerPx:o,reversed:a,config:i}),s}function B(e){var t=e.layout,r=e.feature,o=e.bpPerPx,a=e.reversed,i=e.config,u=n.readConfObject(i,"displayMode"),s="reducedRepresentation"===u?L:G(r),l=r.parent(),c=0;l&&(c=a?(l.get("end")-r.get("end"))/o:(r.get("start")-l.get("start"))/o);var f=n.readConfObject(i,"height",{feature:r}),d=(r.get("end")-r.get("start"))/o,p=t.parent,g=p?p.top:0;return t.addChild(String(r.id()),c,"collapse"===u?0:g,d,"compact"===u?f/2:f,{GlyphComponent:s})}function N(e){var t=e.layout,r=e.bpPerPx,n=e.reversed,o=e.config;e.subfeatures.forEach((function(e){(G(e).layOut||W)({layout:t,feature:e,bpPerPx:r,reversed:n,config:o})}))}function z(e){return/(\bUTR|_UTR|untranslated[_\s]region)\b/.test(e.get("type")||"")}var K={position:"relative"};function X(e){var t,r,o,u,s,l,f=e.feature,d=e.bpPerPx,p=e.region,g=e.config,h=e.displayMode,y=e.layout,v=p.reversed,m=f.get(v?"end":"start"),R=a.bpToPx(m,p,d),x="compact"!==h&&"collapsed"!==h,M=new i("root",0,0,0,0),P=(G(f).layOut||W)({layout:M,feature:f,bpPerPx:d,reversed:v,config:g});if(x){var w=n.readConfObject(g,"showLabels");s=n.readConfObject(g,["labels","fontSize"],{feature:f}),l=n.readConfObject(g,"maxFeatureGlyphExpansion")||0,o=n.readConfObject(g,["labels","name"],{feature:f})||"",t=/\S/.test(o)&&w,u=n.readConfObject(g,["labels","description"],{feature:f})||"",r=/\S/.test(u)&&w;var q=0;t&&(q=Math.round(Math.min(a.measureText(o,s),M.width+l))+2,M.addChild("nameLabel",0,P.bottom+2,q,s));var O=0;if(r){var S=t?M.getSubRecord("nameLabel"):P;O=Math.round(Math.min(a.measureText(u,s),M.width+l))+2,M.addChild("descriptionLabel",0,S.bottom+2,O,s)}}var E=y.addRect(f.id(),f.get("start"),f.get("start")+M.width*d,M.height);return null===E?null:(M.move(R,E),c.createElement(C,b({key:"svg-feature-".concat(f.id()),feature:f,layout:y,rootLayout:M,bpPerPx:d,config:g,name:String(o),shouldShowName:t,description:String(u),shouldShowDescription:r,fontHeight:s,allowedWidthExpansion:l,reversed:p.reversed},e)))}X.propTypes={layout:s.shape({addRect:s.func.isRequired,getTotalHeight:s.func.isRequired}).isRequired,displayMode:s.string.isRequired,region:o.PropTypes.Region.isRequired,bpPerPx:s.number.isRequired,feature:s.shape({id:s.func.isRequired,get:s.func.isRequired}).isRequired,config:o.PropTypes.ConfigSchema.isRequired};var Y=u.observer((function(e){var t,r=[],n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=M(e))){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}(e.features.values());try{for(n.s();!(t=n.n()).done;){var o=t.value;r.push(c.createElement(X,b({key:o.id(),feature:o},e)))}}catch(e){n.e(e)}finally{n.f()}return c.createElement(c.Fragment,null,r)}));function $(e){var t=e.layout,r=e.blockKey,o=e.bpPerPx,a=e.features,i=e.config,u=e.displayModel,s=e.exportSVG,f=x(e.regions||[],1)[0],d=(f.end-f.start)/o,p=n.readConfObject(i,"displayMode"),g=l.useRef(),h=x(l.useState(!1),2),y=h[0],v=h[1],m=x(l.useState(!1),2),R=m[0],M=m[1],P=x(l.useState(0),2),w=P[0],q=P[1],C=e.onMouseOut,O=e.onMouseDown,S=e.onMouseLeave,T=e.onMouseEnter,j=e.onMouseOver,k=e.onMouseMove,L=e.onMouseUp,F=e.onClick,_=l.useCallback((function(e){if(v(!0),M(!1),O)return O(e)}),[O]),V=l.useCallback((function(e){if(v(!1),L)return L(e)}),[L]),U=l.useCallback((function(e){if(T)return T(e)}),[T]),D=l.useCallback((function(e){if(S)return S(e)}),[S]),I=l.useCallback((function(e){if(j)return j(e)}),[j]),A=l.useCallback((function(e){if(C)return C(e)}),[C]),H=l.useCallback((function(e){y&&M(!0);var t=0,n=0;g.current&&(t=g.current.getBoundingClientRect().left,n=g.current.getBoundingClientRect().top),t=e.clientX-t;var a=u.getFeatureOverlapping(r,f.start+o*(f.reversed?d-t:t),n=e.clientY-n);k&&k(e,a)}),[r,o,y,k,f.reversed,f.start,u,d]),G=l.useCallback((function(e){R||F&&F(e)}),[R,F]);return l.useEffect((function(){q(t.getTotalHeight())}),[t]),s?c.createElement(Y,b({features:a,displayMode:p},e,{region:f})):c.createElement("div",{style:K},c.createElement("svg",{ref:g,className:"SvgFeatureRendering",width:"".concat(d,"px"),height:"".concat(w,"px"),onMouseDown:_,onMouseUp:V,onMouseEnter:U,onMouseLeave:D,onMouseOver:I,onMouseOut:A,onMouseMove:H,onFocus:U,onBlur:D,onClick:G,style:{display:"block"}},c.createElement(Y,b({features:a,displayMode:p},e,{region:f,movedDuringLastMouseDown:R})),c.createElement(E,b({},e,{region:f}))))}Y.propTypes={features:s.oneOfType([s.instanceOf(Map),s.arrayOf(s.shape())]),layout:s.shape({addRect:s.func.isRequired,getTotalHeight:s.func.isRequired}).isRequired},Y.defaultProps={features:[]},$.propTypes={layout:s.shape({addRect:s.func.isRequired,getTotalHeight:s.func.isRequired}).isRequired,regions:s.arrayOf(o.PropTypes.Region).isRequired,bpPerPx:s.number.isRequired,features:s.oneOfType([s.instanceOf(Map),s.arrayOf(s.shape())]),config:o.PropTypes.ConfigSchema.isRequired,displayModel:s.shape({configuration:s.shape({}),getFeatureOverlapping:s.func,selectedFeatureId:s.string,featureIdUnderMouse:s.string}),onMouseDown:s.func,onMouseUp:s.func,onMouseEnter:s.func,onMouseLeave:s.func,onMouseOver:s.func,onMouseOut:s.func,onMouseMove:s.func,onClick:s.func,onContextMenu:s.func,onFeatureClick:s.func,onFeatureContextMenu:s.func,blockKey:s.string,exportSVG:s.shape({})},$.defaultProps={displayModel:{},exportSVG:void 0,features:new Map,blockKey:void 0,onMouseDown:void 0,onMouseUp:void 0,onMouseEnter:void 0,onMouseLeave:void 0,onMouseOver:void 0,onMouseOut:void 0,onMouseMove:void 0,onClick:void 0,onContextMenu:void 0,onFeatureClick:void 0,onFeatureContextMenu:void 0};var J=u.observer($),Q=n.ConfigurationSchema("SvgFeatureRenderer",{color1:{type:"color",description:"the main color of each feature",defaultValue:"goldenrod",contextVariable:["feature"]},color2:{type:"color",description:"the secondary color of each feature, used for connecting lines, etc",defaultValue:"black",contextVariable:["feature"]},color3:{type:"color",description:"the tertiary color of each feature, often used for contrasting fills, like on UTRs",defaultValue:"#357089",contextVariable:["feature"]},height:{type:"number",description:"height in pixels of the main body of each feature",defaultValue:10,contextVariable:["feature"]},showLabels:{type:"boolean",defaultValue:!0},labels:n.ConfigurationSchema("SvgFeatureLabels",{name:{type:"string",description:"the primary name of the feature to show, if space is available",defaultValue:"jexl:get(feature,'name') || get(feature,'id')",contextVariable:["feature"]},nameColor:{type:"color",description:"the color of the name label, if shown",defaultValue:"black",contextVariable:["feature"]},description:{type:"string",description:"the text description to show, if space is available",defaultValue:"jexl:get(feature,'note') || get(feature,'description')",contextVariable:["feature"]},descriptionColor:{type:"color",description:"the color of the description, if shown",defaultValue:"blue",contextVariable:["feature"]},fontSize:{type:"number",description:"height in pixels of the text to use for names and descriptions",defaultValue:13,contextVariable:["feature"]}}),displayMode:{type:"stringEnum",model:p.types.enumeration("displayMode",["normal","compact","reducedRepresentation","collapse"]),description:"Alternative display modes",defaultValue:"normal"},maxFeatureGlyphExpansion:{type:"number",description:"maximum number of pixels on each side of a feature's bounding coordinates that a glyph is allowed to use",defaultValue:500},maxHeight:{type:"integer",description:"the maximum height to be used in a svg rendering",defaultValue:600},subParts:{type:"string",description:"subparts for a glyph",defaultValue:"CDS,UTR,five_prime_UTR,three_prime_UTR"},impliedUTRs:{type:"boolean",description:"imply UTR from the exon and CDS differences",defaultValue:!1}},{explicitlyTyped:!0}),Z=function(e){h(n,t);var r=R(n);function n(){var e;return g(this,n),(e=r.apply(this,arguments)).supportsSVG=!0,e}return n}(),ee=function(e){h(o,r);var t,n=R(o);function o(){var e;return g(this,o),(e=n.apply(this,arguments)).name="SVGPlugin",e}return(t=[{key:"install",value:function(e){e.addRendererType((function(){return new Z({name:"SvgFeatureRenderer",ReactComponent:J,configSchema:Q,pluginManager:e})}))}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(o.prototype,t),o}();exports.SvgFeatureRendererReactComponent=J,exports.default=ee,exports.svgFeatureRendererConfigSchema=Q;
//# sourceMappingURL=plugin-svg.cjs.production.min.js.map
